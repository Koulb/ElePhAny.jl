<p align="center">
    <img src="docs/src/assets/logo_readme.png" alt="ElePhAny Logo" width="300"/>
</p>

*‚öõÔ∏è **Electron‚ÄìPhonon** interactions with **Any** functional*

[![Build Status](https://github.com/Koulb/ElePhAny.jl/actions/workflows/CI.yml/badge.svg)](https://github.com/Koulb/ElePhAny.jl/actions) [![Documentation](https://img.shields.io/badge/docs-üìñ-blue.svg)](#) [![ArXiv](https://img.shields.io/badge/arXiv-preprint-orange.svg)](#) [![License: MIT](https://img.shields.io/badge/license-MIT-green.svg)](#)

## Overview

**ElePhAny** is a Julia package for calculating **electron‚Äìphonon coupling matrix** elements using a **finite-difference** approach. It enables first-principles e‚Äìph calculations with **any exchange‚Äìcorrelation functional or beyond-DFT method** (e.g. hybrid functionals, Koopmans functionals, GW), overcoming the limitations of DFPT which only supports standard LDA/GGA functionals.  

ElePhAny constructs the e‚Äìph matrix elements from supercell calculations: it reads eigenvalues and eigenvectors of the pristine and displaced structures and computes the coupling $g_{mn\nu}(\mathbf{k},\mathbf{q})$ by projecting the change in the Hamiltonian onto the displaced Bloch states.  

The code interfaces with ab initio outputs from [Quantum‚ÄØEspresso](https://www.quantum-espresso.org/) (and other codes using QE formats, such as [Koopmans](https://koopmans-functionals.org/en/latest/#) or [Yambo](https://www.yambo-code.eu/)) and can export the resulting e‚Äìph matrices to [EPW](https://epw-code.org/) for further analysis of charge transport, band renormalization, and other properties.

## Features

- üöÄ **General Finite-Difference Method:** Uses finite atomic displacements to evaluate electron‚Äìphonon interactions, avoiding linear-response (DFPT). This **works with any functional**, including orbital-dependent methods beyond DFT. 
- üìê **Eigenvalue Projectability Formula:** Employs an eigenvalue-based projection technique to evaluate electron-phonon coupling, using **only the eigenvalues and eigenvectors** of the unperturbed and displaced systems. This approach yields $g_{mn\nu}$ for **any commensurate**  $\mathbf{k}$-point and $\mathbf{q}$-point in the supercell.   
- ‚öñÔ∏è **Symmetry Reduction:** Exploits crystal symmetries to minimize the number of displacements needed. **Only inequivalent atoms (and directions) are displaced**, and symmetry operations generate the rest, greatly reducing computational cost.  
- üì¶ **EPW Integration:** The computed e‚Äìph matrix elements can be written in EPW format, allowing you to leverage EPW to compute phonon-assisted transport, superconducting $T_c$, etc., using the advanced functional data generated by ElePhAny.

## Installation

1. **Install Julia:** [Download Julia](https://julialang.org/downloads/) (v1.6 or later).  
2. **Add ElePhAny:**  

```julia
   julia> ]
   pkg> add https://github.com/Koulb/ElePhAny.jl
```

2. **(Alternative) Development mode:**

```sh
git clone https://github.com/Koulb/ElePhAny.jl.git
cd ElePhAny.jl
julia
```

In Julia:

```julia
julia> ]
pkg> dev .
```

3. **For Python-like dictionaries support:**

```julia
pkg> add PythonCall
```

## Usage

1. **Run supercell DFT calculations**: ground state + displaced structures.
2. **Process with ElePhAny**: load outputs, compute $g_{mn\nu}(\mathbf{k},\mathbf{q})$.
3. **Export or analyze**: e.g. save in EPW format for further property calculations.

‚û°Ô∏è See the [**documentation**](#) for a full tutorial and API reference.

## Theory Summary

When atoms are displaced, the electronic potential changes, giving rise to an e‚Äìph Hamiltonian:

$$\hat{H}^{\mathrm{e-ph}} = \sum_{\kappa\alpha l} \frac{\partial \hat{V}}{\partial \tau_{\kappa\alpha l}}\,\delta \tau_{\kappa\alpha l}$$

The matrix element is:

$$g_{mn\nu}(\mathbf{k},\mathbf{q}) = \sum_{\kappa,\alpha} 
\sqrt{\frac{\hbar}{2 M_\kappa \omega_{\mathbf{q}\nu}}}
\, e_{\kappa\alpha\mathbf{q}\nu} 
\langle \psi_{m,\mathbf{k+q}}| \tfrac{\partial V}{\partial \tau_{\kappa\alpha}}|\psi_{n,\mathbf{k}}\rangle$$

**ElePhAny** evaluates braket of $\partial V/\partial\tau_{\kappa\alpha}$ via finite differences


```math
\frac{\partial V}{\partial \tau_{\kappa\alpha}} = \frac{\partial \hat{H}}{\partial \tau_{\kappa\alpha}} 
\approx \frac{\hat{H}(+\Delta\tau_{\kappa\alpha}) - \hat{H}(-\Delta\tau_{\kappa\alpha})}{2\,\Delta\tau_{\kappa\alpha}}
```

and eigenvalues and overlaps from pristine/displaced systems:

```math
\langle \psi_{m,\mathbf{k+q}}|\tfrac{\partial V}{\partial \tau_{\kappa\alpha}}|\psi_{n,\mathbf{k}}\rangle 
\approx \frac{1}{2\,\Delta\tau_{\kappa\alpha}}\sum_{j=1}^{N_{\max}}
\Big[\;\varepsilon^{+}_j\,(u^{+}_{j,n\mathbf{k}})^* u^{+}_{j,m\mathbf{k+q}}
-\varepsilon^{-}_j\,(u^{-}_{j,n\mathbf{k}})^* u^{-}_{j,m\mathbf{k+q}}\Big]
```


‚û°Ô∏è See the [**preprint**](#) for full derivation and details.

## References and Resources

* üìñ **Documentation:** *Full usage and API*
* üìÑ **Preprint:** *arXiv link coming soon*
* ‚öôÔ∏è [Quantum Espresso](https://www.quantum-espresso.org/)
* ‚öôÔ∏è [EPW](https://epw-code.org/)
* ‚öôÔ∏è [Koopmans](https://koopmans-functionals.org/en/latest/#)
* ‚öôÔ∏è [Yambo](https://www.yambo-code.eu/)

**License:** MIT

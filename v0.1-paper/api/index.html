<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Index · ElePhAny</title><meta name="title" content="Index · ElePhAny"/><meta property="og:title" content="Index · ElePhAny"/><meta property="twitter:title" content="Index · ElePhAny"/><meta name="description" content="Documentation for ElePhAny."/><meta property="og:description" content="Documentation for ElePhAny."/><meta property="twitter:description" content="Documentation for ElePhAny."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ElePhAny logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ElePhAny</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../theory/">Theory</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>Index</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Electrons"><span>Electrons</span></a></li><li><a class="tocitem" href="#Phonons"><span>Phonons</span></a></li><li><a class="tocitem" href="#Electron-phonon-coupling"><span>Electron-phonon coupling</span></a></li><li><a class="tocitem" href="#Symmetries"><span>Symmetries</span></a></li><li><a class="tocitem" href="#Wave-functions"><span>Wave functions</span></a></li><li><a class="tocitem" href="#Model"><span>Model</span></a></li><li><a class="tocitem" href="#IO"><span>IO</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Index</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Koulb/ElePhAny.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Koulb/ElePhAny.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#ElectronPhonon.Electrons"><code>ElectronPhonon.Electrons</code></a></li><li><a href="#ElectronPhonon.ModelKCW"><code>ElectronPhonon.ModelKCW</code></a></li><li><a href="#ElectronPhonon.ModelQE"><code>ElectronPhonon.ModelQE</code></a></li><li><a href="#ElectronPhonon.Phonons"><code>ElectronPhonon.Phonons</code></a></li><li><a href="#ElectronPhonon.Symmetries"><code>ElectronPhonon.Symmetries</code></a></li><li><a href="#ElectronPhonon.calculate_braket"><code>ElectronPhonon.calculate_braket</code></a></li><li><a href="#ElectronPhonon.calculate_braket_real"><code>ElectronPhonon.calculate_braket_real</code></a></li><li><a href="#ElectronPhonon.check_symmetries"><code>ElectronPhonon.check_symmetries</code></a></li><li><a href="#ElectronPhonon.check_symmetries!"><code>ElectronPhonon.check_symmetries!</code></a></li><li><a href="#ElectronPhonon.collect_forces"><code>ElectronPhonon.collect_forces</code></a></li><li><a href="#ElectronPhonon.create_disp_calc"><code>ElectronPhonon.create_disp_calc</code></a></li><li><a href="#ElectronPhonon.create_disp_calc!"><code>ElectronPhonon.create_disp_calc!</code></a></li><li><a href="#ElectronPhonon.create_electrons"><code>ElectronPhonon.create_electrons</code></a></li><li><a href="#ElectronPhonon.create_model"><code>ElectronPhonon.create_model</code></a></li><li><a href="#ElectronPhonon.create_model_kcw"><code>ElectronPhonon.create_model_kcw</code></a></li><li><a href="#ElectronPhonon.create_perturbed_kcw"><code>ElectronPhonon.create_perturbed_kcw</code></a></li><li><a href="#ElectronPhonon.create_phonons"><code>ElectronPhonon.create_phonons</code></a></li><li><a href="#ElectronPhonon.create_scf_calc"><code>ElectronPhonon.create_scf_calc</code></a></li><li><a href="#ElectronPhonon.determine_fft_grid"><code>ElectronPhonon.determine_fft_grid</code></a></li><li><a href="#ElectronPhonon.determine_phase"><code>ElectronPhonon.determine_phase</code></a></li><li><a href="#ElectronPhonon.determine_q_point"><code>ElectronPhonon.determine_q_point</code></a></li><li><a href="#ElectronPhonon.determine_q_point_cart"><code>ElectronPhonon.determine_q_point_cart</code></a></li><li><a href="#ElectronPhonon.dislpaced_unitecells"><code>ElectronPhonon.dislpaced_unitecells</code></a></li><li><a href="#ElectronPhonon.electron_phonon"><code>ElectronPhonon.electron_phonon</code></a></li><li><a href="#ElectronPhonon.electron_phonon_qe"><code>ElectronPhonon.electron_phonon_qe</code></a></li><li><a href="#ElectronPhonon.find_degenerate"><code>ElectronPhonon.find_degenerate</code></a></li><li><a href="#ElectronPhonon.fold_component"><code>ElectronPhonon.fold_component</code></a></li><li><a href="#ElectronPhonon.fold_kpoint"><code>ElectronPhonon.fold_kpoint</code></a></li><li><a href="#ElectronPhonon.generate_kpoints"><code>ElectronPhonon.generate_kpoints</code></a></li><li><a href="#ElectronPhonon.get_kpoint_list"><code>ElectronPhonon.get_kpoint_list</code></a></li><li><a href="#ElectronPhonon.getfirst"><code>ElectronPhonon.getfirst</code></a></li><li><a href="#ElectronPhonon.include_kpoins"><code>ElectronPhonon.include_kpoins</code></a></li><li><a href="#ElectronPhonon.load_electrons"><code>ElectronPhonon.load_electrons</code></a></li><li><a href="#ElectronPhonon.load_phonons"><code>ElectronPhonon.load_phonons</code></a></li><li><a href="#ElectronPhonon.parse_file"><code>ElectronPhonon.parse_file</code></a></li><li><a href="#ElectronPhonon.parse_fortran_bin"><code>ElectronPhonon.parse_fortran_bin</code></a></li><li><a href="#ElectronPhonon.parse_frozen_params"><code>ElectronPhonon.parse_frozen_params</code></a></li><li><a href="#ElectronPhonon.parse_hdf"><code>ElectronPhonon.parse_hdf</code></a></li><li><a href="#ElectronPhonon.parse_ph"><code>ElectronPhonon.parse_ph</code></a></li><li><a href="#ElectronPhonon.parse_qe_in"><code>ElectronPhonon.parse_qe_in</code></a></li><li><a href="#ElectronPhonon.parse_wf"><code>ElectronPhonon.parse_wf</code></a></li><li><a href="#ElectronPhonon.plot_ep_coupling"><code>ElectronPhonon.plot_ep_coupling</code></a></li><li><a href="#ElectronPhonon.prepare_eigenvalues"><code>ElectronPhonon.prepare_eigenvalues</code></a></li><li><a href="#ElectronPhonon.prepare_kcw_data"><code>ElectronPhonon.prepare_kcw_data</code></a></li><li><a href="#ElectronPhonon.prepare_model"><code>ElectronPhonon.prepare_model</code></a></li><li><a href="#ElectronPhonon.prepare_phonons"><code>ElectronPhonon.prepare_phonons</code></a></li><li><a href="#ElectronPhonon.prepare_phonons_data"><code>ElectronPhonon.prepare_phonons_data</code></a></li><li><a href="#ElectronPhonon.prepare_unfold_to_sc"><code>ElectronPhonon.prepare_unfold_to_sc</code></a></li><li><a href="#ElectronPhonon.prepare_wave_functions_disp"><code>ElectronPhonon.prepare_wave_functions_disp</code></a></li><li><a href="#ElectronPhonon.prepare_wave_functions_to_G"><code>ElectronPhonon.prepare_wave_functions_to_G</code></a></li><li><a href="#ElectronPhonon.prepare_wave_functions_to_R"><code>ElectronPhonon.prepare_wave_functions_to_R</code></a></li><li><a href="#ElectronPhonon.prepare_wave_functions_undisp"><code>ElectronPhonon.prepare_wave_functions_undisp</code></a></li><li><a href="#ElectronPhonon.read_forces_xml"><code>ElectronPhonon.read_forces_xml</code></a></li><li><a href="#ElectronPhonon.read_potential"><code>ElectronPhonon.read_potential</code></a></li><li><a href="#ElectronPhonon.read_qe_xml"><code>ElectronPhonon.read_qe_xml</code></a></li><li><a href="#ElectronPhonon.rotate_deriv"><code>ElectronPhonon.rotate_deriv</code></a></li><li><a href="#ElectronPhonon.rotate_grid"><code>ElectronPhonon.rotate_grid</code></a></li><li><a href="#ElectronPhonon.run_calculations"><code>ElectronPhonon.run_calculations</code></a></li><li><a href="#ElectronPhonon.run_disp_calc"><code>ElectronPhonon.run_disp_calc</code></a></li><li><a href="#ElectronPhonon.run_disp_nscf_calc"><code>ElectronPhonon.run_disp_nscf_calc</code></a></li><li><a href="#ElectronPhonon.run_nscf_calc"><code>ElectronPhonon.run_nscf_calc</code></a></li><li><a href="#ElectronPhonon.run_scf"><code>ElectronPhonon.run_scf</code></a></li><li><a href="#ElectronPhonon.run_scf_cluster"><code>ElectronPhonon.run_scf_cluster</code></a></li><li><a href="#ElectronPhonon.save_dyn_matirx"><code>ElectronPhonon.save_dyn_matirx</code></a></li><li><a href="#ElectronPhonon.save_potential"><code>ElectronPhonon.save_potential</code></a></li><li><a href="#ElectronPhonon.wf_from_G"><code>ElectronPhonon.wf_from_G</code></a></li><li><a href="#ElectronPhonon.wf_from_G_list"><code>ElectronPhonon.wf_from_G_list</code></a></li><li><a href="#ElectronPhonon.wf_from_G_slow"><code>ElectronPhonon.wf_from_G_slow</code></a></li><li><a href="#ElectronPhonon.wf_pc_to_sc"><code>ElectronPhonon.wf_pc_to_sc</code></a></li><li><a href="#ElectronPhonon.wf_phase!"><code>ElectronPhonon.wf_phase!</code></a></li><li><a href="#ElectronPhonon.wf_to_G"><code>ElectronPhonon.wf_to_G</code></a></li><li><a href="#ElectronPhonon.wf_to_G_list"><code>ElectronPhonon.wf_to_G_list</code></a></li></ul><h2 id="Electrons"><a class="docs-heading-anchor" href="#Electrons">Electrons</a><a id="Electrons-1"></a><a class="docs-heading-anchor-permalink" href="#Electrons" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.read_qe_xml" href="#ElectronPhonon.read_qe_xml"><code>ElectronPhonon.read_qe_xml</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_qe_xml(filename::AbstractString)</code></pre><p>Reads and parses a Quantum ESPRESSO XML output file, extracting structural and electronic information.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code>: Path to the Quantum ESPRESSO XML file.</li></ul><p><strong>Returns</strong></p><p>A named tuple containing:</p><ul><li><code>lattice::Mat3</code>: The lattice vectors in Angstroms.</li><li><code>atom_positions::Vector{Vec3{Float64}}</code>: Atomic positions in fractional coordinates.</li><li><code>atom_labels::Vector{String}</code>: Atomic species labels.</li><li><code>recip_lattice::Mat3</code>: Reciprocal lattice vectors in 1/Angstrom.</li><li><code>kpoints::Vector{Vec3{Float64}}</code>: List of k-points in fractional coordinates.</li><li><code>n_electrons::Float64</code>: Number of electrons.</li><li><code>fermi_energy::Float64</code>: Fermi energy in eV.</li><li><code>alat::Float64</code>: Lattice parameter in Angstroms.</li><li><code>eigenvalues_up::Vector{Vector{Float64}}</code> and <code>eigenvalues_dn::Vector{Vector{Float64}}</code>:   (If spin-polarized) Eigenvalues for spin-up and spin-down bands, in eV.</li><li><code>eigenvalues::Vector{Vector{Float64}}</code>: (If not spin-polarized) Eigenvalues for each band, in eV.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L3-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.create_scf_calc" href="#ElectronPhonon.create_scf_calc"><code>ElectronPhonon.create_scf_calc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_scf_calc(path_to_scf::String, unitcell, scf_parameters)</code></pre><p>Creates a self-consistent field (SCF) calculation input for Quantum ESPRESSO.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_scf::String</code>: The file path where the SCF input file will be written.</li><li><code>unitcell</code>: The unit cell parameters or structure information, passed as keyword arguments to <code>ase.Atoms</code>.</li><li><code>scf_parameters</code>: Parameters for the SCF calculation, passed as keyword arguments to <code>ase_io.write</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L152-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.generate_kpoints" href="#ElectronPhonon.generate_kpoints"><code>ElectronPhonon.generate_kpoints</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_kpoints(n1::Int, n2::Int, n3::Int; omit_weight::Bool=false, out_file::String=&quot;&quot;)</code></pre><p>Generates a Monkhorst-Pack grid of k-points for a crystal structure.</p><p><strong>Arguments</strong></p><ul><li><code>n1::Int</code>: Number of k-points along the first reciprocal lattice direction. Must be &gt; 0.</li><li><code>n2::Int</code>: Number of k-points along the second reciprocal lattice direction. Must be &gt; 0.</li><li><code>n3::Int</code>: Number of k-points along the third reciprocal lattice direction. Must be &gt; 0.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>omit_weight::Bool=false</code>: If <code>false</code>, outputs k-points with weights in Quantum ESPRESSO format. If <code>true</code>, outputs only the k-point coordinates in a custom format.</li><li><code>out_file::String=&quot;&quot;</code>: If provided, writes the output to the specified file. Otherwise, prints to standard output.</li></ul><p><strong>Output</strong></p><ul><li>If <code>omit_weight</code> is <code>false</code>, prints or writes the k-points in Quantum ESPRESSO format, including weights.</li><li>If <code>omit_weight</code> is <code>true</code>, prints or writes the k-points in a custom format without weights (W90 style).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L179-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.include_kpoins" href="#ElectronPhonon.include_kpoins"><code>ElectronPhonon.include_kpoins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">include_kpoins(path_to_nscf::String, paht_to_kpts::String)</code></pre><p>Replaces the K_POINTS section in a Quantum ESPRESSO input file with new k-points from a separate file.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_nscf::String</code>: Path to the NSCF input file to be modified.</li><li><code>paht_to_kpts::String</code>: Path to the file containing new k-points.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L241-L250">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.create_disp_calc" href="#ElectronPhonon.create_disp_calc"><code>ElectronPhonon.create_disp_calc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_disp_calc(path_to_in::String, path_to_qe::String, unitcell, scf_parameters, abs_disp, sc_size, k_mesh, use_symm; from_scratch = false)</code></pre><p>Set up the directory structure and input files for a displacement calculation, used in electron-phonon coupling workflows.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the working directory where calculations will be set up.</li><li><code>path_to_qe::String</code>: Path to the Quantum ESPRESSO installation or utilities.</li><li><code>unitcell</code>: The unit cell structure object.</li><li><code>scf_parameters</code>: Dictionary of parameters for the self-consistent field (SCF) calculation.</li><li><code>abs_disp</code>: Magnitude of atomic displacements to apply.</li><li><code>sc_size</code>: Supercell size (integer).</li><li><code>k_mesh</code>: Number of k-points in each direction for the k-point mesh.</li><li><code>use_symm</code>: Boolean or flag to indicate whether to use symmetry in generating displacements.</li><li><code>from_scratch</code> (optional): If <code>true</code>, cleans and recreates the displacement directory. Default is <code>false</code>.</li></ul><p><strong>Description</strong></p><p>This function:</p><ul><li>Creates a directory structure for displacement calculations.</li><li>Generates k-point files for SCF and NSCF calculations.</li><li>Prepares input files for SCF and NSCF calculations for the undistorted and displaced structures.</li><li>Copies necessary scripts (e.g., <code>run.sh</code>) into calculation directories.</li><li>Handles special cases for hybrid functionals (e.g., <code>nqx1</code>, <code>nqx2</code>, <code>nqx3</code>).</li><li>Returns the number of displaced structures generated.</li></ul><p><strong>Returns</strong></p><ul><li><code>Ndispalce::Int</code>: The number of displaced structures (and corresponding calculation groups) created.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L278-L305">source</a></section><section><div><pre><code class="language-julia hljs">create_disp_calc(model::ModelKCW; from_scratch = false)</code></pre><p>Creates displacement calculations for a given <code>ModelKCW</code> object by preparing directories and input files for each displaced structure.</p><p><strong>Arguments</strong></p><ul><li><code>model::ModelKCW</code>: The model containing calculation parameters and paths.</li><li><code>from_scratch::Bool=false</code>: (Optional) If true, forces recreation of displacement calculations from scratch.</li></ul><p><strong>Description</strong></p><p>This function:</p><ol><li>Checks for the existence of required files (<code>koopmans.json</code> and <code>koopmans_sc.json</code>) in the model&#39;s calculation path.</li><li>Creates an <code>unperturbed</code> directory and copies necessary files (<code>run.sh</code>, <code>koopmans.json</code>) into it.</li><li>Generates displaced unit cells using <code>dislpaced_unitecells</code>.</li><li>For each displacement:<ul><li>Creates a new directory (<code>perturbedN/</code>).</li><li>Copies the <code>run.sh</code> script into the new directory.</li><li>Reads the pristine <code>koopmans_sc.json</code> file.</li><li>Creates a perturbed version of the JSON data using <code>create_perturbed_kcw</code>.</li><li>Writes the perturbed JSON to the corresponding directory.</li></ul></li></ol><p><strong>Returns</strong></p><ul><li><code>Ndispalce::Int</code>: The number of displaced unit cells generated.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L472-L495">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.create_disp_calc!" href="#ElectronPhonon.create_disp_calc!"><code>ElectronPhonon.create_disp_calc!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_disp_calc!(model::ModelQE; from_scratch = false)</code></pre><p>Prepares the displacement calculation environment for a given <code>ModelQE</code> instance. This function manages the setup of the directory structure required for displacement calculations, optionally cleaning up any existing data if <code>from_scratch</code> is set to <code>true</code>.</p><p><strong>Arguments</strong></p><ul><li><code>model::ModelQE</code>: The model object containing calculation parameters and paths.</li><li><code>from_scratch::Bool=false</code>: If <code>true</code>, removes the existing <code>displacements</code> directory before creating a new one.</li></ul><p><strong>Behavior</strong></p><ul><li>Cleans the <code>displacements</code> directory if <code>from_scratch</code> is <code>true</code>.</li><li>Creates a new <code>displacements</code> directory if it does not exist.</li><li>If <code>model.use_symm</code> is <code>true</code>, checks and applies symmetries to reduce the number of displacements.</li><li>Calls <code>create_disp_calc</code> to generate the required displacement calculations.</li><li>Verifies consistency between the number of displacements calculated by Phonopy and the symmetry calculation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L401-L418">source</a></section><section><div><pre><code class="language-julia hljs">create_disp_calc!(model::ModelKCW; from_scratch = false)</code></pre><p>Prepares the displacement calculation environment for a given <code>model</code> of type <code>ModelKCW</code>.</p><p><strong>Arguments</strong></p><ul><li><code>model::ModelKCW</code>: The model object containing calculation parameters and paths.</li><li><code>from_scratch::Bool=false</code>: If <code>true</code>, removes the existing <code>displacements</code> directory before creating a new one.</li></ul><p><strong>Description</strong></p><ul><li>Optionally cleans the <code>displacements</code> directory if <code>from_scratch</code> is set.</li><li>Creates a new <code>displacements</code> directory in the model&#39;s calculation path.</li><li>If symmetry usage is enabled (<code>model.use_symm</code>), checks and applies symmetries.</li><li>If symmetries are not used, calculates the number of displacements as <code>6 * number of atoms</code> and prints relevant information.</li><li>Calls <code>create_disp_calc(model)</code> to generate displacements and checks for consistency in the number of displacements between Phonopy and symmetry calculations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L552-L567">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.create_perturbed_kcw" href="#ElectronPhonon.create_perturbed_kcw"><code>ElectronPhonon.create_perturbed_kcw</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_perturbed_kcw(pristine_data, unitcell)</code></pre><p>Updates the atomic positions in the <code>pristine_data</code> dictionary with the scaled positions from the <code>unitcell</code>.</p><p><strong>Returns</strong></p><ul><li>The updated <code>pristine_data</code> dictionary with atomic positions replaced by the corresponding scaled positions from <code>unitcell</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L457-L464">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.run_scf" href="#ElectronPhonon.run_scf"><code>ElectronPhonon.run_scf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_scf(path_to_in::String, mpi_ranks::Int = 0)</code></pre><p>Runs a self-consistent field (SCF) calculation using Quantum ESPRESSO&#39;s <code>pw.x</code> executable.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the directory containing the <code>scf.in</code> input file.</li><li><code>mpi_ranks::Int=0</code>: Number of MPI ranks to use. If greater than 0, runs the calculation in parallel using <code>mpirun</code>; otherwise, runs in serial.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L594-L602">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.run_scf_cluster" href="#ElectronPhonon.run_scf_cluster"><code>ElectronPhonon.run_scf_cluster</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_scf_cluster(path_to_in::String)</code></pre><p>Submits a batch job for a self-consistent field (SCF) calculation on a computing cluster.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: The path to the directory containing the input files and the <code>run.sh</code> script.</li></ul><p><strong>Description</strong></p><p>Changes the working directory to <code>path_to_in</code>, then submits the <code>run.sh</code> script as a batch job using <code>sbatch</code>. The standard output and error of the job submission command are redirected to <code>run.out</code> and <code>errs.txt</code>, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L616-L626">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.run_nscf_calc" href="#ElectronPhonon.run_nscf_calc"><code>ElectronPhonon.run_nscf_calc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_nscf_calc(path_to_in::String, mpi_ranks)</code></pre><p>Runs a non-self-consistent field (NSCF) calculation for electronic structure simulations.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: The base path to the input directory containing the SCF calculation results.</li><li><code>mpi_ranks</code>: The number of MPI ranks to use for parallel execution. If greater than 0, runs the calculation in parallel.</li></ul><p><strong>Description</strong></p><p>This function performs the following steps:</p><ol><li>Changes the working directory to the SCF calculation directory (<code>scf_0</code>).</li><li>Copies the <code>run.sh</code> script to <code>run_nscf.sh</code> and modifies it to use <code>nscf.in</code> instead of <code>scf.in</code>.</li><li>Submits the NSCF calculation using <code>sbatch</code> if the <code>run_nscf.sh</code> script exists.</li><li>If the script does not exist, runs the calculation directly using <code>pw.x</code> (with or without MPI, depending on <code>mpi_ranks</code>).</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L636-L651">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.run_disp_calc" href="#ElectronPhonon.run_disp_calc"><code>ElectronPhonon.run_disp_calc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_disp_calc(path_to_in::String, Ndispalce::Int, mpi_ranks::Int = 0) -&gt; Bool</code></pre><p>Runs self-consistent field (SCF) calculations for a set of atomic displacements in a specified directory.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing displacement subdirectories.</li><li><code>Ndispalce::Int</code>: Number of displacement groups to process.</li><li><code>mpi_ranks::Int=0</code>: Number of MPI ranks to use for the SCF calculation (default is 0).</li></ul><p><strong>Description</strong></p><p>The function first runs an SCF calculation in the <code>scf_0</code> subdirectory. If a <code>run.sh</code> script is present, it uses <code>run_scf_cluster</code>; otherwise, it uses <code>run_scf</code>. Then, for each displacement group (from 1 to <code>Ndispalce</code>), it runs the corresponding SCF calculation in the <code>group_i</code> subdirectory, using the same logic for <code>run.sh</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L701-L713">source</a></section><section><div><pre><code class="language-julia hljs">run_disp_calc(model::ModelKCW) -&gt; Bool</code></pre><p>Runs self-consistent field (SCF) calculations for both unperturbed and perturbed configurations of a given model.</p><p><strong>Arguments</strong></p><ul><li><code>model::ModelKCW</code>: The model object containing calculation parameters, including the path to calculation directories and the number of displacements (<code>Ndispalce</code>).</li></ul><p><strong>Description</strong></p><p>This function performs the following steps:</p><ol><li>Runs an SCF calculation in the &quot;unperturbed&quot; subdirectory of the specified calculation path.</li><li>Iterates over the number of displacements (<code>Ndispalce</code>) defined in the model, running SCF calculations in each corresponding &quot;perturbed&quot; subdirectory (e.g., &quot;perturbed1/&quot;, &quot;perturbed2/&quot;, etc.).</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L823-L835">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.run_disp_nscf_calc" href="#ElectronPhonon.run_disp_nscf_calc"><code>ElectronPhonon.run_disp_nscf_calc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_disp_nscf_calc(path_to_in::String, Ndispalce::Int, mpi_ranks::Int = 0)</code></pre><p>Runs non-self-consistent field (NSCF) calculations for a series of atomic displacements.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing displacement groups.</li><li><code>Ndispalce::Int</code>: Number of displacement groups to process.</li><li><code>mpi_ranks::Int=0</code>: Number of MPI ranks to use for parallel execution. If set to 0, runs in serial mode.</li></ul><p><strong>Description</strong></p><p>For each displacement group (from 1 to <code>Ndispalce</code>), the function:</p><ol><li>Changes the working directory to the corresponding displacement group directory.</li><li>Attempts to copy the SCF XML file containing forces to a backup file.</li><li>Copies and modifies the <code>run.sh</code> script to create a <code>run_nscf.sh</code> script, replacing occurrences of <code>&quot;scf.in&quot;</code> with <code>&quot;nscf.in&quot;</code>.</li><li>If a <code>run_nscf.sh</code> script exists, submits it as a batch job using <code>sbatch</code>, redirecting output and errors.</li><li>If not, runs the NSCF calculation directly using <code>pw.x</code> (with or without MPI, depending on <code>mpi_ranks</code>), redirecting output and errors.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L744-L761">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_kcw_data" href="#ElectronPhonon.prepare_kcw_data"><code>ElectronPhonon.prepare_kcw_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_kcw_data(model::ModelKCW) -&gt; Int</code></pre><p>Prepares the necessary directory structure and files for Koopmans calculation for a given <code>ModelKCW</code> instance.</p><p><strong>Arguments</strong></p><ul><li><code>model::ModelKCW</code>: The model object containing all relevant paths, parameters, and settings for the calculation.</li></ul><p><strong>Description</strong></p><p>This function performs the following steps:</p><ol><li>Creates required directories for displacements, and electron-phonon elements.</li><li>Sets up the self-consistent field (SCF) calculation directory and copies necessary wavefunction and data files from the unperturbed calculation.</li><li>Copies the non-self-consistent field (NSCF) output file to the SCF directory.</li><li>Generates a k-point mesh file for the supercell.</li><li>Calls <code>dislpaced_unitecells</code> to generate displaced unit cells based on the model parameters.</li><li>For each displacement, creates the appropriate directory and links the corresponding wavefunction and data files from the perturbed calculations.</li></ol><p><strong>Returns</strong></p><ul><li><code>Int</code>: The number of displacements (<code>model.Ndispalce</code>) processed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L852-L871">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.read_potential" href="#ElectronPhonon.read_potential"><code>ElectronPhonon.read_potential</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_potential(path_to_file::String; skiprows=0)</code></pre><p>Reads a KS potential data file and returns a 3D array of Float64 values along with its dimensions.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_file::String</code>: Path to the file containing the potential data.</li><li><code>skiprows</code>: (Optional) Number of initial rows to skip in the file. Default is 0.</li></ul><p><strong>Returns</strong></p><ul><li><code>ff::Array{Float64,3}</code>: 3D array of potential values with dimensions <code>(N1, N2, N3)</code>.</li><li><code>N1::Int</code>: Size of the first dimension.</li><li><code>N2::Int</code>: Size of the second dimension.</li><li><code>N3::Int</code>: Size of the third dimension.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L943-L957">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.save_potential" href="#ElectronPhonon.save_potential"><code>ElectronPhonon.save_potential</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_potential(path_to_in::String, Ndispalce, sc_size, mpi_ranks)</code></pre><p>Saves the electronic potential for a series of displaced structures by running Quantum ESPRESSO&#39;s <code>pp.x</code> post-processing tool.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the directory containing input files for each displacement.</li><li><code>Ndispalce</code>: Number of displacement configurations to process.</li><li><code>sc_size</code>: Size of the supercell. If greater than 1, the potential is repeated accordingly.</li><li><code>mpi_ranks</code>: Number of MPI ranks to use for parallel execution. If greater than 0, runs <code>pp.x</code> with MPI.</li></ul><p><strong>Description</strong></p><p>For each displacement (and the undisplaced structure), this function:</p><ul><li>Changes to the appropriate directory.</li><li>Writes a <code>pp.in</code> input file for <code>pp.x</code> with predefined parameters.</li><li>Runs <code>pp.x</code> (optionally in parallel) to generate the potential file.</li><li>For the undisplaced structure and if <code>sc_size &gt; 1</code>, reads the potential, repeats it to match the supercell size, and saves it in JLD2 format.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L1011-L1028">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.get_kpoint_list" href="#ElectronPhonon.get_kpoint_list"><code>ElectronPhonon.get_kpoint_list</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_kpoint_list(path_to_in)</code></pre><p>Reads a list of k-points from a file named <code>kpoints.dat</code> located in the directory specified by <code>path_to_in</code>.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::AbstractString</code>: Path to the directory containing the <code>kpoints.dat</code> file.</li></ul><p><strong>Returns</strong></p><ul><li><code>klist::Vector{Vector{Float64}}</code>: A vector of k-points, where each k-point is represented as a vector of <code>Float64</code> values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L1091-L1101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.fold_kpoint" href="#ElectronPhonon.fold_kpoint"><code>ElectronPhonon.fold_kpoint</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fold_kpoint(ik, iq, k_list)</code></pre><p>Given indices <code>ik</code> and <code>iq</code> into the list of k-points <code>k_list</code>, the function computes the index of the k-point in <code>k_list</code> that corresponds to the sum of <code>k_list[ik]</code> and <code>k_list[iq]</code>, folded back into the first Brillouin zone.</p><p><strong>Arguments</strong></p><ul><li><code>ik::Int</code>: Index of the first k-point in <code>k_list</code>.</li><li><code>iq::Int</code>: Index of the second k-point in <code>k_list</code>.</li><li><code>k_list::AbstractVector{&lt;:AbstractVector}</code>: List of k-points (each k-point is a vector).</li></ul><p><strong>Returns</strong></p><ul><li><code>ikq::Int</code>: Index in <code>k_list</code> of the folded sum of <code>k_list[ik]</code> and <code>k_list[iq]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L1120-L1132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_eigenvalues" href="#ElectronPhonon.prepare_eigenvalues"><code>ElectronPhonon.prepare_eigenvalues</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_eigenvalues(path_to_in::String, natoms::Int; Ndisplace::Int = 6*natoms, ineq_atoms_list::Vector{Int}=[], spin_channel::String=&quot;&quot;)</code></pre><p>Prepares and saves eigenvalues for displaced atomic configurations.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing calculation data.</li><li><code>natoms::Int</code>: Number of atoms in the system.</li><li><code>Ndisplace::Int=6*natoms</code>: Number of atomic displacements (default is 6 times the number of atoms).</li><li><code>ineq_atoms_list::Vector{Int}=[]</code>: List of indices for inequivalent atoms (used if <code>Ndisplace</code> differs from <code>6*natoms</code>).</li><li><code>spin_channel::String=&quot;&quot;</code>: Spin channel to use; can be <code>&quot;up&quot;</code>, <code>&quot;dw&quot;</code>, or <code>&quot;&quot;</code> for non-spin-polarized.</li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li><code>ϵkᵤ_list</code>: Eigenvalues for the undistorted structure.</li><li><code>ϵₚ_list</code>: List of eigenvalues for positive displacements.</li><li><code>ϵₚₘ_list</code>: List of eigenvalues for negative displacements.</li><li><code>k_list</code>: List of k-points.</li></ul><p><strong>Saves</strong></p><ul><li><code>scf_0/ek_list.jld2</code>: Eigenvalues for the undistorted structure.</li><li><code>scf_0/ep_list.jld2</code>: Eigenvalues for positive displacements.</li><li><code>scf_0/epm_list.jld2</code>: Eigenvalues for negative displacements.</li><li><code>scf_0/k_list.jld2</code>: List of k-points.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L1155-L1179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.create_electrons" href="#ElectronPhonon.create_electrons"><code>ElectronPhonon.create_electrons</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_electrons(path_to_in::String, natoms::Int, sc_size::Int, k_mesh::Int) -&gt; Electrons</code></pre><p>Creates and returns an <code>Electrons</code> object by preparing the necessary matrices and eigenvalues.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input file or directory containing required data.</li><li><code>natoms::Int</code>: Number of atoms in the system.</li><li><code>sc_size::Int</code>: Supercell size.</li><li><code>k_mesh::Int</code>: Number of k-points in the mesh.</li></ul><p><strong>Returns</strong></p><ul><li><code>Electrons</code>: An <code>Electrons</code> object initialized with the computed matrices and eigenvalues.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L1232-L1245">source</a></section><section><div><pre><code class="language-julia hljs">create_electrons(model::AbstractModel)</code></pre><p>Creates an <code>Electrons</code> object based on the provided <code>model</code>. This function extracts relevant properties from the model, such as <code>spin_channel</code> and <code>symmetries</code>, and uses them to prepare the necessary matrices and eigenvalues for the electron calculations.</p><p><strong>Arguments</strong></p><ul><li><code>model::AbstractModel</code>: The model containing all necessary information about the system, including unit cell, calculation paths, supercell size, k-point mesh, and optional properties like <code>spin_channel</code> and <code>symmetries</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Electrons</code>: An object containing the prepared U and V matrices, eigenvalues, and k-point list for the electron system.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L1253-L1263">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.load_electrons" href="#ElectronPhonon.load_electrons"><code>ElectronPhonon.load_electrons</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_electrons(model::AbstractModel) -&gt; Electrons</code></pre><p>Loads electron-related data from disk for the given <code>model</code>. The function reads several arrays from JLD2 files located in the <code>displacements/scf_0/</code> subdirectory of <code>model.path_to_calc</code>, including:</p><ul><li><code>U_list</code>: Unitary matrices for electron states.</li><li><code>V_list</code>: Additional matrices for electron states.</li><li><code>ϵkᵤ_list</code>: Eigenvalues of undisplaced configuration.</li><li><code>ϵₚ_list</code>: Eigenvalues of displaced (+tau) configuration.</li><li><code>ϵₚₘ_list</code>: Eigenvalues of displaced (-tau) configuration.</li><li><code>k_list</code>: List of k-points in reciprocal space.</li></ul><p>Returns an <code>Electrons</code> object constructed from the loaded data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electrons.jl#L1284-L1297">source</a></section></article><h2 id="Phonons"><a class="docs-heading-anchor" href="#Phonons">Phonons</a><a id="Phonons-1"></a><a class="docs-heading-anchor-permalink" href="#Phonons" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.determine_q_point" href="#ElectronPhonon.determine_q_point"><code>ElectronPhonon.determine_q_point</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_q_point(path_to_in, iq; sc_size=1, use_sc=false)</code></pre><p>Determines the q-point from a k-points file.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::AbstractString</code>: Path to the directory containing the k-points files.</li><li><code>iq::Integer</code>: Index of the q-point to retrieve (1-based).</li><li><code>sc_size::Number=1</code>: Scaling factor for the q-point (default is 1).</li><li><code>use_sc::Bool=false</code>: If <code>true</code>, use the supercell k-points file (<code>kpoints_sc.dat</code>); otherwise, use the regular k-points file (<code>kpoints.dat</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float64}</code>: The q-point at index <code>iq</code>, scaled by <code>sc_size</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.determine_q_point_cart" href="#ElectronPhonon.determine_q_point_cart"><code>ElectronPhonon.determine_q_point_cart</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_q_point_cart(path_to_in, ik)</code></pre><p>Extracts the Cartesian coordinates of the <code>ik</code>-th k-point from a Quantum ESPRESSO <code>scf.out</code> file located in the specified directory.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the directory containing the <code>scf.out</code> file.</li><li><code>ik::Int</code>: Index of the k-point to extract (1-based).</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float64}</code>: A vector of length 3 containing the Cartesian coordinates of the specified k-point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L28-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.read_forces_xml" href="#ElectronPhonon.read_forces_xml"><code>ElectronPhonon.read_forces_xml</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_forces_xml(path_to_xml::String) -&gt; Matrix{Float64}</code></pre><p>Reads atomic forces from a Quantum ESPRESSO XML output file.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_xml::String</code>: Path to the XML file containing the forces data.</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Float64}</code>: A matrix of size (N_atoms, 3), where each row corresponds to the force vector (in Hartree/Bohr) acting on an atom.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L63-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.dislpaced_unitecells" href="#ElectronPhonon.dislpaced_unitecells"><code>ElectronPhonon.dislpaced_unitecells</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dislpaced_unitecells(path_to_save, unitcell, abs_disp, sc_size, use_symm)</code></pre><p>Generates supercells with atomic displacements for phonon calculations using Phonopy.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_save::String</code>: Path where the Phonopy parameter file (<code>phonopy_params.yaml</code>) will be saved.</li><li><code>unitcell::Dict</code>: Dictionary describing the unit cell. Must contain keys <code>:symbols</code>, <code>:cell</code>, <code>:scaled_positions</code>, and <code>:masses</code>.</li><li><code>abs_disp::Float64</code>: Magnitude of the atomic displacement (in Angstroms).</li><li><code>sc_size::Int</code>: Size of the supercell (applied equally along all three axes).</li><li><code>use_symm::Bool</code>: Whether to use symmetry operations in generating displacements.</li></ul><p><strong>Returns</strong></p><ul><li><code>supercells::Vector{Dict}</code>: A vector of dictionaries, each representing a supercell with displaced atoms. Each dictionary contains keys <code>:symbols</code>, <code>:cell</code>, <code>:scaled_positions</code>, and <code>:masses</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L84-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.collect_forces" href="#ElectronPhonon.collect_forces"><code>ElectronPhonon.collect_forces</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">collect_forces(path_to_in::String, unitcell, sc_size, Ndispalce)</code></pre><p>Collects atomic forces from a series of displacement calculations.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the directory containing displacement calculation results.</li><li><code>unitcell</code>: Data structure containing information about the unit cell, including atomic symbols.</li><li><code>sc_size</code>: Integer specifying the size of the supercell (number of unit cells along one dimension).</li><li><code>Ndispalce</code>: Number of displacement calculations (i.e., number of displaced configurations).</li></ul><p><strong>Returns</strong></p><ul><li><code>forces::Array{Float64, 3}</code>: 3D array of shape <code>(Ndispalce, number_atoms, 3)</code> containing the forces for each displacement and atom.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L123-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.save_dyn_matirx" href="#ElectronPhonon.save_dyn_matirx"><code>ElectronPhonon.save_dyn_matirx</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_dyn_matirx(path_to_in::String, sc_size::Int) -&gt; Bool</code></pre><p>Saves the dynamical matrices for a supercell of size <code>sc_size^3</code> to disk.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing phonopy files (e.g., <code>phonopy_params.yaml</code>).</li><li><code>sc_size::Int</code>: The size of the supercell along one dimension (total number of q-points is <code>sc_size^3</code>).</li></ul><p><strong>Description</strong></p><p>For each q-point in the supercell:</p><ul><li>Loads phonon parameters using Phonopy.</li><li>Computes the dynamical matrix at the q-point.</li><li>Applies phase and mass factors to construct the dynamical matrix in QE gage.</li><li>Saves the resulting matrix to a file in a newly created <code>dyn_mat</code> subdirectory.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L158-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_phonons_data" href="#ElectronPhonon.prepare_phonons_data"><code>ElectronPhonon.prepare_phonons_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_phonons_data(path_to_in::String, unitcell, abs_disp, sc_size, k_mesh, use_symm, Ndispalce::Int64; save_dynq=true)</code></pre><p>Prepares phonon data by collecting forces and processing them for further calculations.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory or file containing force data.</li><li><code>unitcell</code>: The unit cell structure or object.</li><li><code>abs_disp</code>: Absolute displacement value(s) used for phonon calculations.</li><li><code>sc_size</code>: Supercell size or dimensions.</li><li><code>k_mesh</code>: k-point mesh for Brillouin zone sampling.</li><li><code>use_symm</code>: Boolean or flag indicating whether to use symmetry operations.</li><li><code>Ndispalce::Int64</code>: Number of displacements to consider.</li><li><code>save_dynq</code> (optional): Whether to save the dynamical matrix (<code>true</code> by default).</li></ul><p><strong>Returns</strong></p><ul><li>The processed phonon data, ready for further analysis or calculations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L224-L242">source</a></section><section><div><pre><code class="language-julia hljs">prepare_phonons_data(path_to_in::String, unitcell, abs_disp, sc_size, k_mesh, use_symm, forces::Array{Float64}; save_dynq=true)</code></pre><p>Prepares phonon calculation data using Phonopy and Quantum ESPRESSO.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory where files will be read/written.</li><li><code>unitcell</code>: Dictionary containing unit cell information, including <code>:symbols</code>, <code>:cell</code>, and <code>:scaled_positions</code>.</li><li><code>abs_disp</code>: Absolute displacement value for generating phonon displacements.</li><li><code>sc_size</code>: Integer specifying the size of the supercell.</li><li><code>k_mesh</code>: Integer specifying the k-point mesh size.</li><li><code>use_symm</code>: Boolean indicating whether to use symmetry in phonon calculations.</li><li><code>forces::Array{Float64}</code>: Array of forces to be set in the phonon object.</li><li><code>save_dynq</code> (optional, default=<code>true</code>): Whether to save the dynamical matrix after calculation.</li></ul><p><strong>Description</strong></p><p>This function:</p><ul><li>Converts unit cell parameters to the appropriate units and format for Phonopy.</li><li>Initializes a Phonopy object with the given unit cell, supercell size, and symmetry settings.</li><li>Produces and optionally symmetrizes the force constants.</li><li>Saves Phonopy parameters to a YAML file.</li><li>Constructs and writes a configuration file for further phonon calculations.</li><li>Runs the Phonopy command-line tool to compute phonon properties.</li><li>Optionally saves the dynamical matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L249-L273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_phonons" href="#ElectronPhonon.prepare_phonons"><code>ElectronPhonon.prepare_phonons</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_phonons(path_to_in::String, sc_size::Int)</code></pre><p>Prepares and processes phonon data for a given system.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing phonopy and phonon calculation files.</li><li><code>sc_size::Int</code>: Size of the supercell (used to determine the number of q-points).</li></ul><p><strong>Outputs</strong></p><ul><li><code>M_phonon</code>: Array of transformation matrices for each atom, used to convert between Cartesian and phonon displacement bases.</li><li><code>ωₐᵣᵣ_ₗᵢₛₜ</code>: List of phonon frequency arrays for each q-point.</li><li><code>εₐᵣᵣ_ₗᵢₛₜ</code>: List of phonon eigenvector arrays for each q-point.</li><li><code>mₐᵣᵣ</code>: Array of atomic masses.</li></ul><p><strong>Side Effects</strong></p><p>Saves the following files in the <code>scf_0</code> subdirectory of <code>path_to_in</code>:</p><ul><li><code>M_phonon.jld2</code>: Contains the transformation matrices.</li><li><code>m_arr.jld2</code>: Contains the atomic masses.</li><li><code>omega_arr_list.jld2</code>: Contains the list of phonon frequencies.</li><li><code>eps_arr_list.jld2</code>: Contains the list of phonon eigenvectors.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L391-L412">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.create_phonons" href="#ElectronPhonon.create_phonons"><code>ElectronPhonon.create_phonons</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_phonons(path_to_in::String, sc_size::Int) -&gt; Phonons</code></pre><p>Creates a <code>Phonons</code> object by preparing phonon data.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input file containing phonon data.</li><li><code>sc_size::Int</code>: Supercell size parameter used for phonon preparation.</li></ul><p><strong>Returns</strong></p><ul><li><code>Phonons</code>: An instance of the <code>Phonons</code> type containing the mass matrix, frequency array, eigenvector array, and mass array.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L480-L492">source</a></section><section><div><pre><code class="language-julia hljs">create_phonons(model::AbstractModel) -&gt; Phonons</code></pre><p>Creates a <code>Phonons</code> object for the given <code>model</code>. This function prepares the phonon data by calculating the supercell size, loading phonon matrices, frequencies, eigenvectors, and atomic masses from the specified displacement calculation directory.</p><p><strong>Arguments</strong></p><ul><li><code>model::AbstractModel</code>: The model containing information about the k-point mesh, supercell size, and path to displacement calculations.</li></ul><p><strong>Returns</strong></p><ul><li><code>Phonons</code>: An object containing the phonon matrix, frequency arrays, eigenvector arrays, and atomic mass array.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L499-L511">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.load_phonons" href="#ElectronPhonon.load_phonons"><code>ElectronPhonon.load_phonons</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_phonons(model::AbstractModel) -&gt; Phonons</code></pre><p>Loads phonon-related data from disk for the given <code>model</code> and returns a <code>Phonons</code> object.</p><p><strong>Arguments</strong></p><ul><li><code>model::AbstractModel</code>: The model containing the path to the calculation directory.</li></ul><p><strong>Returns</strong></p><ul><li><code>Phonons</code>: An object containing the loaded phonon mass matrix (<code>M_phonon</code>),</li></ul><p>list of phonon frequencies (<code>ωₐᵣᵣ_ₗᵢₛₜ</code>), list of phonon eigenvectors (<code>εₐᵣᵣ_ₗᵢₛₜ</code>), and atomic masses (<code>mₐᵣᵣ</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/phonons.jl#L519-L531">source</a></section></article><h2 id="Electron-phonon-coupling"><a class="docs-heading-anchor" href="#Electron-phonon-coupling">Electron-phonon coupling</a><a id="Electron-phonon-coupling-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-phonon-coupling" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.run_calculations" href="#ElectronPhonon.run_calculations"><code>ElectronPhonon.run_calculations</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_calculations(model::ModelQE)</code></pre><p>Performs a series of calculations for a given <code>ModelQE</code> instance related to electron and phonon interactions.</p><p><strong>Arguments</strong></p><ul><li><code>model::ModelQE</code>: The model containing calculation parameters and paths.</li></ul><p><strong>Description</strong></p><p>This function runs the following calculations in sequence:</p><ol><li>Electron displacement calculations using <code>run_disp_calc</code>.</li><li>Non-self-consistent field (NSCF) calculations using <code>run_nscf_calc</code>.</li><li>Displacement NSCF calculations using <code>run_disp_nscf_calc</code>.</li></ol><p>All calculations are performed in the directory specified by <code>model.path_to_calc * &quot;displacements/&quot;</code>, using the number of displacements (<code>model.Ndispalce</code>) and MPI ranks (<code>model.mpi_ranks</code>) specified in the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L4-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_model" href="#ElectronPhonon.prepare_model"><code>ElectronPhonon.prepare_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_model(model::ModelQE)</code></pre><p>Prepares the model for electron-phonon calculations based on the provided <code>ModelQE</code> object.</p><p><strong>Arguments</strong></p><ul><li><code>model::ModelQE</code>: The model configuration containing calculation parameters, paths, and settings.</li></ul><p><strong>Description</strong></p><p>This function performs the following steps:</p><ul><li>Checks for unsupported combinations of symmetry and k-point mesh in supercell calculations.</li><li>For calculations with both k-point mesh and supercell size greater than 1, reads structural data, computes a unified grid, and prepares undistorted and distorted wave functions.</li><li>For calculations with only supercell size greater than 1 (and k-point mesh equal to 1), prepares undistorted wave functions.</li><li>Prepares phonon data for all cases.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L29-L43">source</a></section><section><div><pre><code class="language-julia hljs">prepare_model(model::ModelKCW)</code></pre><p>Prepares the given <code>ModelKCW</code> model for further calculations. This function performs the following steps:</p><ol><li>Calls <code>prepare_kcw_data(model)</code> to set up necessary data for the model.</li><li>Calls <code>prepare_wave_functions_undisp</code> with the path to the displacement calculations and the supercell size to prepare wave functions without displacements.</li></ol><p><strong>Arguments</strong></p><ul><li><code>model::ModelKCW</code>: The model object containing all necessary parameters and paths for preparation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L68-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.electron_phonon_qe" href="#ElectronPhonon.electron_phonon_qe"><code>ElectronPhonon.electron_phonon_qe</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">electron_phonon_qe(path_to_in::String, ik::Int, iq::Int, mpi_ranks::Int, path_to_qe::String)</code></pre><p>Runs a Quantum ESPRESSO phonon calculation for electron-phonon coupling at specified k- and q-points.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing calculation files.</li><li><code>ik::Int</code>: Index of the k-point to use.</li><li><code>iq::Int</code>: Index of the q-point to use.</li><li><code>mpi_ranks::Int</code>: Number of MPI ranks (processes) to use for parallel execution.</li><li><code>path_to_qe::String</code>: Path to the Quantum ESPRESSO installation or executable directory.</li></ul><p><strong>Description</strong></p><p>This function:</p><ul><li>Changes the working directory to the specified input directory.</li><li>Constructs a dictionary of input parameters for the <code>ph.x</code> Quantum ESPRESSO module.</li><li>Writes the input file <code>ph.in</code> for the phonon calculation.</li><li>Executes the <code>ph.x</code> program using MPI, redirecting output and error streams to files.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L116-L134">source</a></section><section><div><pre><code class="language-julia hljs">electron_phonon_qe(model::ModelQE, ik::Int, iq::Int)</code></pre><p>Computes electron-phonon coupling using  Quantum ESPRESSO for a given model.</p><p><strong>Arguments</strong></p><ul><li><code>model::ModelQE</code>: The Quantum ESPRESSO model containing calculation parameters and paths.</li><li><code>ik::Int</code>: Index of the k-point.</li><li><code>iq::Int</code>: Index of the q-point.</li></ul><p><strong>Returns</strong></p><ul><li>The result of the electron-phonon coupling calculation for the specified k-point and q-point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L181-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.find_degenerate" href="#ElectronPhonon.find_degenerate"><code>ElectronPhonon.find_degenerate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_degenerate(energies, thr=1e-3)</code></pre><p>Groups nearly degenerate energy levels within a given threshold.</p><p><strong>Arguments</strong></p><ul><li><code>energies::AbstractVector{&lt;:Real}</code>: A vector of energy values, assumed to be sorted.</li><li><code>thr::Real=1e-3</code>: Threshold for considering two energies as degenerate (default: <code>1e-3</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>ineq_ener::Vector{&lt;:Real}</code>: Vector of unique (inequivalent) energies, each representing a group of degenerate states.</li><li><code>eq_states::Vector{Vector{Int}}</code>: A vector of vectors, where each subvector contains the indices of <code>energies</code> that are degenerate with the corresponding entry in <code>ineq_ener</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L198-L210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.parse_ph" href="#ElectronPhonon.parse_ph"><code>ElectronPhonon.parse_ph</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_ph(file_name, nbands, nfreq)</code></pre><p>Parse electron-phonon matrix elements from a ph.out file.</p><p><strong>Arguments</strong></p><ul><li><code>file_name::AbstractString</code>: Path to the input file containing electron-phonon data.</li><li><code>nbands::Int</code>: Number of electronic bands.</li><li><code>nfreq::Int</code>: Number of phonon frequencies.</li></ul><p><strong>Returns</strong></p><ul><li><code>elph_dfpt::Array{ComplexF64,3}</code>: A 3D array of size <code>(nbands, nbands, nfreq)</code> containing the parsed electron-phonon matrix elements (in meV).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L228-L240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.electron_phonon" href="#ElectronPhonon.electron_phonon"><code>ElectronPhonon.electron_phonon</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">electron_phonon(
    path_to_in::String,
    abs_disp,
    Nat,
    ik,
    iq,
    sc_size,
    k_mesh,
    ϵkᵤ_list,
    ϵₚ_list,
    ϵₚₘ_list,
    k_list,
    U_list,
    V_list,
    M_phonon,
    ωₐᵣᵣ_ₗᵢₛₜ,
    εₐᵣᵣ_ₗᵢₛₜ,
    mₐᵣᵣ;
    save_epw::Bool=false
)</code></pre><p>Compute electron-phonon matrix elements using the frozen-phonon approach.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input calculation directory.</li><li><code>abs_disp</code>: Absolute displacement used in frozen-phonon calculations.</li><li><code>Nat</code>: Number of atoms in the unit cell.</li><li><code>ik</code>: Index of the k-point.</li><li><code>iq</code>: Index of the q-point.</li><li><code>sc_size</code>: Supercell size.</li><li><code>k_mesh</code>: Number of k-points in the mesh.</li><li><code>ϵkᵤ_list</code>: List of eigenvalues for each k-point.</li><li><code>ϵₚ_list</code>: List of perturbed eigenvalues for positive displacement.</li><li><code>ϵₚₘ_list</code>: List of perturbed eigenvalues for negative displacements.</li><li><code>k_list</code>: List of k-points.</li><li><code>U_list</code>: List of braket matrices for positive displacements.</li><li><code>V_list</code>: List of braket matrices for negative displacements.</li><li><code>M_phonon</code>: List of phonon rotation matrices for each atom.</li><li><code>ωₐᵣᵣ_ₗᵢₛₜ</code>: List of phonon frequencies for each q-point.</li><li><code>εₐᵣᵣ_ₗᵢₛₜ</code>: List of phonon eigenvectors for each q-point.</li><li><code>mₐᵣᵣ</code>: List of atomic masses.</li><li><code>save_epw::Bool=false</code>: If <code>true</code>, saves the rotated braket list for EPW.</li></ul><p><strong>Returns</strong></p><ul><li>If <code>save_epw</code> is <code>true</code>, returns the rotated braket list (<code>braket_list_rotated</code>).</li><li>Otherwise, returns the symmetrized electron-phonon matrix elements (<code>symm_elph</code>).</li></ul><p><strong>Description</strong></p><p>This function computes the electron-phonon coupling matrix elements by evaluating the overlap (&quot;braket&quot;) between electronic states perturbed by atomic displacements. The calculation is performed for each atom and Cartesian direction, and the results are rotated into the phonon eigenmode basis. The function also symmetrizes the resulting matrix elements over phonon and electronic states and compares them with DFPT results if available.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L297-L351">source</a></section><section><div><pre><code class="language-julia hljs">electron_phonon(path_to_in::String, abs_disp, natoms, ik, iq, sc_size, electrons::AbstractElectrons, phonons::AbstractPhonons; save_epw::Bool=false, path_to_calc=&quot;&quot;, kcw_chanel=&quot;&quot;)</code></pre><p>High-level interface for computing electron-phonon interactions when Electrons and Phonons are provided.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input file or directory.</li><li><code>abs_disp</code>: Absolute displacement parameter (type depends on context).</li><li><code>natoms</code>: Number of atoms in the system.</li><li><code>ik</code>: Index of the k-point.</li><li><code>iq</code>: Index of the q-point.</li><li><code>sc_size</code>: Supercell size.</li><li><code>electrons::AbstractElectrons</code>: Object containing electronic structure data.</li><li><code>phonons::AbstractPhonons</code>: Object containing phonon data.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>save_epw::Bool=false</code>: Whether to save the EPW (Electron-Phonon Wannier) data.</li><li><code>path_to_calc=&quot;&quot;</code>: Optional path to calculation directory.</li><li><code>kcw_chanel=&quot;&quot;</code>: Optional kcw channel specification.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L743-L762">source</a></section><section><div><pre><code class="language-julia hljs">electron_phonon(model::AbstractModel, ik, iq, electrons::AbstractElectrons, phonons::AbstractPhonons; save_epw::Bool=false, path_to_calc=&quot;&quot;, kcw_chanel=&quot;&quot;)</code></pre><p>Compute electron-phonon coupling properties for the given model, electron, and phonon objects.</p><p><strong>Arguments</strong></p><ul><li><code>model::AbstractModel</code>: The model containing system parameters and calculation paths.</li><li><code>ik</code>: Index or identifier for the electron k-point.</li><li><code>iq</code>: Index or identifier for the phonon q-point.</li><li><code>electrons::AbstractElectrons</code>: Object containing electronic structure data (eigenvalues, k-points, etc.).</li><li><code>phonons::AbstractPhonons</code>: Object containing phonon properties (modes, frequencies, etc.).</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>save_epw::Bool=false</code>: Whether to save the electron-phonon Wannier (EPW) data.</li><li><code>path_to_calc::String=&quot;&quot;</code>: Path to the calculation directory (overrides model&#39;s path if provided).</li><li><code>kcw_chanel::String=&quot;&quot;</code>: Optional spin chanel for KCW (&quot;up&quot; has KI functional and &quot;down&quot; has DFT).</li></ul><p><strong>Description</strong></p><p>This function prepares and calls the lower-level electron-phonon coupling calculation using the provided model, electron, and phonon data. It extracts relevant properties from the <code>electrons</code> and <code>phonons</code> objects and passes them, along with model and calculation parameters, to the core computation routine.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L779-L798">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.plot_ep_coupling" href="#ElectronPhonon.plot_ep_coupling"><code>ElectronPhonon.plot_ep_coupling</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_ep_coupling(path_to_in::String, ik::Int, iq::Int; nbnd_max=-1)</code></pre><p>Reads electron-phonon coupling data from a specified file, generates a scatter plot comparing two coupling values, and saves the plot as a PNG image.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing the <code>out/comparison_ik_iq.txt</code> file.</li><li><code>ik::Int</code>: Index of the k-point used in the filename.</li><li><code>iq::Int</code>: Index of the q-point used in the filename.</li><li><code>nbnd_max::Int</code> (optional; default: -1): If greater than 0, only data with band indices less than <code>nbnd_max</code> are included.</li></ul><p><strong>Returns</strong></p><ul><li><code>(x, y)</code>: Two arrays of <code>Float64</code> containing DFPT and FP data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L668-L681">source</a></section><section><div><pre><code class="language-julia hljs">plot_ep_coupling(model::ModelQE, ik::Int=0, iq::Int=0; nbnd_max=-1)</code></pre><p>Plots the electron-phonon coupling for a given <code>ModelQE</code> instance.</p><p><strong>Arguments</strong></p><ul><li><code>model::ModelQE</code>: The model containing electron-phonon calculation data.</li><li><code>ik::Int=0</code>: Index of the k-point to plot (default is 0).</li><li><code>iq::Int=0</code>: Index of the q-point to plot (default is 0).</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>nbnd_max::Int=-1</code>: Maximum number of bands to include in the plot (default is -1, which may indicate all bands).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/electron_phonons.jl#L726-L738">source</a></section></article><h2 id="Symmetries"><a class="docs-heading-anchor" href="#Symmetries">Symmetries</a><a id="Symmetries-1"></a><a class="docs-heading-anchor-permalink" href="#Symmetries" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.check_symmetries" href="#ElectronPhonon.check_symmetries"><code>ElectronPhonon.check_symmetries</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_symmetries(path_to_calc, unitcell, sc_size, abs_disp)</code></pre><p>Checks the symmetries of atomic displacements in a crystal structure using Phonopy.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_calc::String</code>: Path to the calculation directory where displacement files will be saved.</li><li><code>unitcell::Dict</code>: Dictionary containing unit cell information with keys:<ul><li><code>:symbols</code>: Atomic symbols.</li><li><code>:cell</code>: Lattice vectors.</li><li><code>:scaled_positions</code>: Atomic positions in scaled coordinates.</li><li><code>:masses</code>: Atomic masses.</li></ul></li><li><code>sc_size::Int</code>: Size of the supercell (applied equally along all axes).</li><li><code>abs_disp::Float64</code>: Magnitude of the atomic displacement to generate.</li></ul><p><strong>Returns</strong></p><ul><li><code>Symmetries</code>: An object containing:<ul><li>List of inequivalent atom indices.</li><li>List of translation vectors for each symmetry operation.</li><li>List of rotation matrices for each symmetry operation.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/symmetries.jl#L1-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.check_symmetries!" href="#ElectronPhonon.check_symmetries!"><code>ElectronPhonon.check_symmetries!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_symmetries!(model::AbstractModel)</code></pre><p>Checks the symmetries of the given <code>model</code> and updates its symmetry-related fields in-place.</p><p><strong>Arguments</strong></p><ul><li><code>model::AbstractModel</code>: The model object containing calculation path, unit cell, supercell size, and displacement information.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/symmetries.jl#L103-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.fold_component" href="#ElectronPhonon.fold_component"><code>ElectronPhonon.fold_component</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fold_component(x, eps=5e-3)</code></pre><p>Folds the input value <code>x</code> into the interval <code>[0, 1)</code> within a tolerance <code>eps</code>.</p><p>If <code>x</code> is greater than or equal to <code>1 - eps</code>, repeatedly subtracts 1 until <code>x</code> falls within the interval. If <code>x</code> is less than <code>0 - eps</code>, repeatedly adds 1 until <code>x</code> falls within the interval.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>: The value to be folded.</li><li><code>eps</code>: (optional) Tolerance for the interval boundaries. Default is <code>5e-3</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/symmetries.jl#L152-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.rotate_grid" href="#ElectronPhonon.rotate_grid"><code>ElectronPhonon.rotate_grid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rotate_grid(N1, N2, N3, rot, tras)</code></pre><p>Maps a 3D grid of points onto itself under a given rotation and translation, returning a mapping of indices.</p><p><strong>Arguments</strong></p><ul><li><code>N1::Int</code>: Number of grid points along the first axis.</li><li><code>N2::Int</code>: Number of grid points along the second axis.</li><li><code>N3::Int</code>: Number of grid points along the third axis.</li><li><code>rot::AbstractMatrix</code>: 3x3 rotation matrix to apply to each grid point.</li><li><code>tras::AbstractVector</code>: 3-element translation vector to apply after rotation (in fractional coordinates).</li></ul><p><strong>Returns</strong></p><ul><li><code>mapp::Vector{Int}</code>: A vector containing the mapped linear indices for each grid point after applying the rotation and translation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/symmetries.jl#L177-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.rotate_deriv" href="#ElectronPhonon.rotate_deriv"><code>ElectronPhonon.rotate_deriv</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rotate_deriv(N1, N2, N3, mapp, ff)</code></pre><p>Rotate a 3D array <code>ff</code> according to a mapping array <code>mapp</code> and the specified dimensions <code>N1</code>, <code>N2</code>, <code>N3</code>.</p><p><strong>Arguments</strong></p><ul><li><code>N1::Int</code>: Size of the first dimension.</li><li><code>N2::Int</code>: Size of the second dimension.</li><li><code>N3::Int</code>: Size of the third dimension.</li><li><code>mapp::Vector{Int}</code>: Mapping array that specifies the new indices for rotation. Each entry maps a linear index in the original array to a new position.</li><li><code>ff::Array{ComplexF64,3}</code>: The original 3D array to be rotated.</li></ul><p><strong>Returns</strong></p><ul><li><code>ff_rot::Array{ComplexF64,3}</code>: The rotated 3D array.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/symmetries.jl#L221-L235">source</a></section></article><h2 id="Wave-functions"><a class="docs-heading-anchor" href="#Wave-functions">Wave functions</a><a id="Wave-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Wave-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.parse_wf" href="#ElectronPhonon.parse_wf"><code>ElectronPhonon.parse_wf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_wf(path::String)</code></pre><p>Parses a wave function file specified by <code>path</code>. The function checks for the existence of either a <code>.dat</code> or <code>.hdf5</code> file with the given base path. Returns a tuple <code>(miller, evc_list)</code> containing the Miller indices and the eigenvector coefficients.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: The base path (without extension) to the wave function file.</li></ul><p><strong>Returns</strong></p><ul><li><code>miller</code>: Miller indices 3xNG.</li><li><code>evc_list</code>: List of eigenvector coefficients parsed from the file NbandsxNg.</li></ul><p><strong>Throws</strong></p><ul><li>An error if neither a <code>.dat</code> nor a <code>.hdf5</code> file is found at the specified path.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L3-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.parse_hdf" href="#ElectronPhonon.parse_hdf"><code>ElectronPhonon.parse_hdf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_hdf(path::String) -&gt; (miller, evc_list)</code></pre><p>Parse an HDF5 file at the given <code>path</code> to extract Miller indices and eigenvector coefficients.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: The file path to the HDF5 file.</li></ul><p><strong>Returns</strong></p><ul><li><code>miller</code>: Array containing Miller indices.</li><li><code>evc_list</code>: Vector of complex eigenvector coefficients, where each element corresponds to a band.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L35-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.parse_fortran_bin" href="#ElectronPhonon.parse_fortran_bin"><code>ElectronPhonon.parse_fortran_bin</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_fortran_bin(path::String) -&gt; (miller, evc_list)</code></pre><p>Parse an Fortran biniary file at the given <code>path</code> to extract Miller indices and eigenvector coefficients.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: The file path to the wfc#.dat file.</li></ul><p><strong>Returns</strong></p><ul><li><code>miller</code>: Array containing Miller indices.</li><li><code>evc_list</code>: Vector of complex eigenvector coefficients, where each element corresponds to a band.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L73-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.wf_from_G" href="#ElectronPhonon.wf_from_G"><code>ElectronPhonon.wf_from_G</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wf_from_G(miller::Matrix{Int32}, evc::Vector{ComplexF64}, Nxyz) -&gt; Array{ComplexF64, 3}</code></pre><p>Constructs a real-space wave function from its plane-wave expansion coefficients in reciprocal space.</p><p><strong>Arguments</strong></p><ul><li><code>miller::Matrix{Int32}</code>: A 3×N matrix where each column represents a Miller index (reciprocal lattice vector) for a plane wave component.</li><li><code>evc::Vector{ComplexF64}</code>: A vector of complex coefficients corresponding to each Miller index, representing the amplitude and phase of each plane wave.</li><li><code>Nxyz</code>: The size of the cubic grid in each spatial dimension (assumes a cubic box of size Nxyz × Nxyz × Nxyz).</li></ul><p><strong>Returns</strong></p><ul><li><code>wave_function::Array{ComplexF64, 3}</code>: The reconstructed wave function in real space, represented as a 3D array of complex values.</li></ul><p><strong>Details</strong></p><ul><li>The function maps Miller indices to the appropriate indices in a reciprocal space grid, fills in the provided coefficients, and then performs an inverse FFT (using <code>bfft</code> after <code>ifftshift</code>) to obtain the real-space wave function.</li><li>The Miller indices are shifted and wrapped to fit within the grid dimensions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L100-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.wf_from_G_slow" href="#ElectronPhonon.wf_from_G_slow"><code>ElectronPhonon.wf_from_G_slow</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wf_from_G_slow(miller::Matrix{Int32}, evc::Vector{ComplexF64}, Nxyz) -&gt; Array{ComplexF64,3}</code></pre><p>Constructs a real-space wave function on a 3D grid from its plane-wave expansion coefficients withot FFT.</p><p><strong>Arguments</strong></p><ul><li><code>miller::Matrix{Int32}</code>: A matrix where each column represents a reciprocal lattice vector (Miller indices) for the plane-wave basis.</li><li><code>evc::Vector{ComplexF64}</code>: The expansion coefficients (eigenvector components) corresponding to each plane-wave basis vector.</li><li><code>Nxyz</code>: The number of grid points along each spatial dimension (assumes a cubic grid).</li></ul><p><strong>Returns</strong></p><ul><li><code>wave_function::Array{ComplexF64,3}</code>: The computed wave function values on a 3D grid of size <code>(Nxyz, Nxyz, Nxyz)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L137-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.wf_from_G_list" href="#ElectronPhonon.wf_from_G_list"><code>ElectronPhonon.wf_from_G_list</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wf_from_G_list(miller::Matrix{Int32}, evc_list::AbstractArray{Any}, Nxyz) -&gt; Array{ComplexF64, 4}</code></pre><p>Constructs the real-space wave function from a list of plane-wave coefficients and their corresponding Miller indices.</p><p><strong>Arguments</strong></p><ul><li><code>miller::Matrix{Int32}</code>: A 3×N matrix where each column contains the Miller indices (G-vectors) for a plane wave.</li><li><code>evc_list::AbstractArray{Any}</code>: A list (or array) of Nbands wave-functions&#39; coefficients corresponding to each G-vector.</li><li><code>Nxyz</code>: The size of the cubic grid in each spatial direction.</li></ul><p><strong>Returns</strong></p><ul><li><code>wave_function::Array{ComplexF64, 4}</code>: A 4D array of complex values representing the wave function in real space, with dimensions <code>(N_evc, Nxyz, Nxyz, Nxyz)</code>, where <code>N_evc</code> is the number of eigenvector coefficients.</li></ul><p><strong>Description</strong></p><p>This function maps the plane-wave coefficients onto a reciprocal space grid according to their Miller indices, applies an inverse FFT shift, and then performs an inverse FFT to obtain the real-space wave function. The function is parallelized over the Miller index list for efficiency.</p><p><strong>Notes</strong></p><ul><li>The Miller indices are shifted to map correctly onto the FFT grid.</li><li>The function assumes a cubic grid and that the Miller indices are provided in the correct format.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L175-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.wf_to_G" href="#ElectronPhonon.wf_to_G"><code>ElectronPhonon.wf_to_G</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wf_to_G(miller::Matrix{Int32}, wfc, Nxyz) -&gt; Vector{ComplexF64}</code></pre><p>Transforms a wave function <code>wfc</code> from real space to G-space using the provided Miller indices.</p><p><strong>Arguments</strong></p><ul><li><code>miller::Matrix{Int32}</code>: A 3×N matrix where each column represents a Miller index (G-vector) in reciprocal space.</li><li><code>wfc</code>: The wave function Nxyz×Nxyz×Nxyz in real space, assumed to be a 3D array compatible with FFT operations.</li><li><code>Nxyz</code>: The size of the FFT grid along each dimension (assumed cubic).</li></ul><p><strong>Returns</strong></p><ul><li><code>evc_sc::Vector{ComplexF64}</code>: The wave function coefficients in G-space, normalized.</li></ul><p><strong>Notes</strong></p><ul><li>The function applies an FFT and fftshift to the input wave function, then extracts the coefficients corresponding to the provided Miller indices.</li><li>The output is normalized such that its norm is 1.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L220-L236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.wf_to_G_list" href="#ElectronPhonon.wf_to_G_list"><code>ElectronPhonon.wf_to_G_list</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wf_to_G_list(miller::Matrix{Int32}, wfc::AbstractArray{ComplexF64, 4}, Nxyz) -&gt; Matrix{ComplexF64}</code></pre><p>Transforms a list of real-space wave functions <code>wfc</code> into a list of G-space wave functions.</p><p><strong>Arguments</strong></p><ul><li><code>miller::Matrix{Int32}</code>: A 3×Ng matrix where each column represents the Miller indices (G-vector components) for which the plane-wave coefficients are to be extracted.</li><li><code>wfc::AbstractArray{ComplexF64, 4}</code>: The real-space wave function array with dimensions (Nbands, Nx, Ny, Nz), where Nevc is the number of eigenvectors (bands), and Nx, Ny, Nz are the grid sizes in each spatial direction.</li><li><code>Nxyz</code>: The size of the FFT grid in each spatial direction (assumed cubic).</li></ul><p><strong>Returns</strong></p><ul><li><code>evc_sc::Matrix{ComplexF64}</code>: A matrix of size (Nbands, NG), where each column contains the plane-wave coefficients for the corresponding G-vector from <code>miller</code>.</li></ul><p><strong>Notes</strong></p><ul><li>The function assumes that the FFT grid is cubic (Nx = Ny = Nz = Nxyz).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L257-L272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.wf_pc_to_sc" href="#ElectronPhonon.wf_pc_to_sc"><code>ElectronPhonon.wf_pc_to_sc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wf_pc_to_sc(wfc, sc_size)</code></pre><p>Expands a wave function <code>wfc</code> defined in a primitive cell to a supercell of size <code>sc_size × sc_size × sc_size</code>.</p><p><strong>Arguments</strong></p><ul><li><code>wfc</code>: The wave function array defined in the primitive cell.</li><li><code>sc_size</code>: The size of the supercell along each spatial dimension.</li></ul><p><strong>Returns</strong></p><ul><li><code>wfc_sc</code>: The wave function array repeated to fill the supercell.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L299-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.determine_fft_grid" href="#ElectronPhonon.determine_fft_grid"><code>ElectronPhonon.determine_fft_grid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_fft_grid(path_to_file::String; use_xml::Bool = false) -&gt; Int</code></pre><p>Determines the FFT grid size (<code>Nxyz</code>) from a given file.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_file::String</code>: Path to the file containing FFT grid information. This can be either an XML file or a plain text output file.</li><li><code>use_xml::Bool = false</code>: If <code>true</code>, parses the file as an XML file; otherwise, parses it as a plain text file.</li></ul><p><strong>Returns</strong></p><ul><li><code>Nxyz</code>: The FFT grid size along each dimension.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L316-L327">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.determine_phase" href="#ElectronPhonon.determine_phase"><code>ElectronPhonon.determine_phase</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_phase(q_point, Nxyz)</code></pre><p>Compute the phase factor <code>exp(2im * π * dot(r, q_point))</code> on a 3D grid of size <code>Nxyz × Nxyz × Nxyz</code>.</p><p><strong>Arguments</strong></p><ul><li><code>q_point::AbstractVector</code>: A 3-element vector representing the q-point in reciprocal space.</li><li><code>Nxyz</code>: The number of grid points along each spatial dimension.</li></ul><p><strong>Returns</strong></p><ul><li><code>exp_factor::Array{Complex{Float64},3}</code>: A 3D array of complex phase factors evaluated at each grid point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L368-L379">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_unfold_to_sc" href="#ElectronPhonon.prepare_unfold_to_sc"><code>ElectronPhonon.prepare_unfold_to_sc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_unfold_to_sc(path_to_in::String, sc_size::Int, ik::Int)</code></pre><p>Prepares and saves the unfolded wave functions for a supercell calculation.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing required files.</li><li><code>sc_size::Int</code>: Supercell size multiplier.</li><li><code>ik::Int</code>: Index of the k-point to process.</li></ul><p><strong>Description</strong></p><p>This function performs the following steps:</p><ol><li>Determines the q-point vector for the specified k-point.</li><li>Calculates the phase factor for the q-point and FFT grid.</li><li>Loads the list of wave functions from a JLD2 file.</li><li>For each wave function:<ul><li>Converts it from primitive cell to supercell representation.</li><li>Applies the calculated phase factor.</li><li>Stores the processed wave function in a new dictionary.</li></ul></li><li>Saves the processed wave functions to a new JLD2 file with a modified filename.</li></ol><p><strong>Output</strong></p><p>Saves the processed wave functions with phase factors applied to a file named <code>wfc_list_phase_ik.jld2</code> in the specified input directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L403-L426">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.wf_phase!" href="#ElectronPhonon.wf_phase!"><code>ElectronPhonon.wf_phase!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wf_phase!(path_to_in::String, wfc::AbstractArray{ComplexF64, 4}, sc_size::Int, ik::Int)</code></pre><p>Applies a phase factor to an array of complex wave functions  <code>wfc</code> in-place, based on the specified supercell size and k-point index.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing SCF calculation outputs.</li><li><code>wfc::AbstractArray{ComplexF64, 4}</code>: 4D array Nbands × Nxyz × Nxyz × Nxyz representing the wave functions to be modified.</li><li><code>sc_size::Int</code>: Supercell size multiplier.</li><li><code>ik::Int</code>: Index of the k-point for which the phase factor is determined.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L447-L458">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_wave_functions_to_R" href="#ElectronPhonon.prepare_wave_functions_to_R"><code>ElectronPhonon.prepare_wave_functions_to_R</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_wave_functions_to_R(path_to_in::String; ik::Int=1)</code></pre><p>Prepares and saves wave functions in real space for a given k-point index.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing calculation results.</li><li><code>ik::Int=1</code>: (Optional) Index of the k-point to process. Defaults to 1.</li></ul><p><strong>Output</strong></p><p>Saves a dictionary of wave functions to a file named <code>wfc_list_&lt;ik&gt;.jld2</code> in the specified input directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L472-L483">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_wave_functions_to_G" href="#ElectronPhonon.prepare_wave_functions_to_G"><code>ElectronPhonon.prepare_wave_functions_to_G</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_wave_functions_to_G(path_to_in::String; ik::Int=1)</code></pre><p>Loads wave function in real space from a specified directory, transforms them to G-space and saves the resulting data.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing the wave function files.</li><li><code>ik::Int=1</code>: (Optional) Index of the k-point to process.</li></ul><p><strong>Description</strong></p><p>This function:</p><ol><li>Loads the wave function list for the specified k-point from a JLD2 file.</li><li>Determines the grid size and Miller indices by parsing a reference wave function file.</li><li>Transforms each wave function in the list to G-space using <code>wf_to_G</code>.</li><li>Saves the resulting dictionary of G-space wave functions to a new JLD2 file.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L502-L517">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_wave_functions_undisp" href="#ElectronPhonon.prepare_wave_functions_undisp"><code>ElectronPhonon.prepare_wave_functions_undisp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_wave_functions_undisp(path_to_in::String, ik::Int, sc_size::Int)</code></pre><p>Prepares wave functions for further calculations by performing the following steps:</p><ol><li>Transforms wave functions to real (R) space for the specified k-point.</li><li>Unfolds the wave functions to the supercell of given size.</li><li>Transforms the wave functions back to reciprocal (G) space.</li></ol><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing wave function data.</li><li><code>ik::Int</code>: Index of the k-point to process.</li><li><code>sc_size::Int</code>: Size of the supercell for unfolding.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L679-L692">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.prepare_wave_functions_disp" href="#ElectronPhonon.prepare_wave_functions_disp"><code>ElectronPhonon.prepare_wave_functions_disp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_wave_functions_disp(path_to_in::String, ik::Int, Ndisplace::Int, sc_size::Int, k_mesh::Int)</code></pre><p>Prepares and processes wave functions for a set of displaced structures in a supercell calculation.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory containing data for each displacement group.</li><li><code>ik::Int</code>: Index of the k-point for which the wave functions are prepared.</li><li><code>Ndisplace::Int</code>: Number of displacement groups to process.</li><li><code>sc_size::Int</code>: Size of the supercell (number of unit cells along one dimension).</li><li><code>k_mesh::Int</code>: Number of k-points in the mesh (currently unused in the function).</li></ul><p><strong>Description</strong></p><p>For each displacement group, this function:</p><ol><li>Parses the wave function coefficients from the corresponding data files.</li><li>Processes the wave functions in chunks to manage memory usage:<ul><li>Converts G-space coefficients to real-space wave functions.</li><li>Applies phase factor.</li><li>Converts the corrected wave functions back to G-space.</li></ul></li><li>Saves the phase-corrected wave function coefficients to a JLD2 file for each displacement group.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L710-L730">source</a></section><section><div><pre><code class="language-julia hljs">prepare_wave_functions_disp(path_to_in::String, Ndisplace::Int, sc_size::Int, k_mesh::Int)</code></pre><p>A wrapper function that calls another method of <code>prepare_wave_functions_disp</code> with an additional k-point index argument.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_in::String</code>: Path to the input directory or file.</li><li><code>Ndisplace::Int</code>: Number of displacements to consider.</li><li><code>sc_size::Int</code>: Size of the supercell.</li><li><code>k_mesh::Int</code>: Number of k-points along each reciprocal lattice direction.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L764-L773">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.calculate_braket_real" href="#ElectronPhonon.calculate_braket_real"><code>ElectronPhonon.calculate_braket_real</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_braket_real(bra::Array{Complex{Float64}, 3}, ket::Array{Complex{Float64}, 3}) -&gt; Complex{Float64}</code></pre><p>Calculates the normalized inner product ⟨bra|ket⟩ between two 3D complex-valued arrays <code>bra</code> and <code>ket</code>.</p><p><strong>Arguments</strong></p><ul><li><code>bra::Array{Complex{Float64}, 3}</code>: The &quot;bra&quot; vector, represented as a 3D array of complex numbers.</li><li><code>ket::Array{Complex{Float64}, 3}</code>: The &quot;ket&quot; vector, represented as a 3D array of complex numbers.</li></ul><p><strong>Returns</strong></p><ul><li><code>Complex{Float64}</code>: The normalized inner product ⟨bra|ket⟩, computed as the sum over all elements of <code>conj(bra[i]) * ket[i]</code>, divided by the total number of elements.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L930-L941">source</a></section><section><div><pre><code class="language-julia hljs">calculate_braket_real(bras::Dict{String, Array{Complex{Float64}, 3}}, kets::Dict{String, Array{Complex{Float64}, 3}}) -&gt; Array{Complex{Float64}, 2}</code></pre><p>Compute the matrix of real-valued inner product ⟨bra|ket⟩ values between sets of &quot;bra&quot; and &quot;ket&quot; wave functions.</p><p><strong>Arguments</strong></p><ul><li><code>bras</code>: A dictionary mapping string identifiers to 3-dimensional arrays of complex numbers, representing the &quot;bra&quot; wave functions.</li><li><code>kets</code>: A dictionary mapping string identifiers to 3-dimensional arrays of complex numbers, representing the &quot;ket&quot; wave functions.</li></ul><p><strong>Returns</strong></p><ul><li>A 2D array of complex numbers where the element at position <code>(i, j)</code> contains the result of <code>calculate_braket_real</code> applied to the <code>i</code>-th bra and <code>j</code>-th ket.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L954-L965">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.calculate_braket" href="#ElectronPhonon.calculate_braket"><code>ElectronPhonon.calculate_braket</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_braket(bra::Array{Complex{Float64}}, ket::Array{Complex{Float64}}) -&gt; Complex{Float64}</code></pre><p>Computes the inner product ⟨bra|ket⟩ between two complex-valued vectors.</p><p><strong>Arguments</strong></p><ul><li><code>bra::Array{Complex{Float64}}</code>: The &quot;bra&quot; vector (conjugate transpose).</li><li><code>ket::Array{Complex{Float64}}</code>: The &quot;ket&quot; vector.</li></ul><p><strong>Returns</strong></p><ul><li><code>Complex{Float64}</code>: The resulting inner product as a complex number.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L978-L989">source</a></section><section><div><pre><code class="language-julia hljs">calculate_braket(bras, kets)</code></pre><p>Compute the matrix of inner products ⟨bra|ket⟩ between two collections of quantum states.</p><p><strong>Arguments</strong></p><ul><li><code>bras</code>: A collection (e.g., array or vector) of bra vectors (quantum states).</li><li><code>kets</code>: A collection (e.g., array or vector) of ket vectors (quantum states).</li></ul><p><strong>Returns</strong></p><ul><li>A matrix of complex numbers where the element at position (i, j) is the inner product between <code>bras[i]</code> and <code>kets[j]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/wave_function.jl#L1001-L1013">source</a></section></article><h2 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.Symmetries" href="#ElectronPhonon.Symmetries"><code>ElectronPhonon.Symmetries</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Symmetries</code></pre><p>A structure representing the symmetries of a system.</p><p><strong>Fields</strong></p><ul><li><code>ineq_atoms_list::Vector{Int64}</code>: List of indices of inequivalent atoms in the system.</li><li><code>trans_list::Vector{Vector{Float64}}</code>: List of translation vectors associated with each symmetry operation.</li><li><code>rot_list::Vector{Matrix{Float64}}</code>: List of rotation matrices corresponding to each symmetry operation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/model.jl#L6-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.ModelQE" href="#ElectronPhonon.ModelQE"><code>ElectronPhonon.ModelQE</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModelQE &lt;: AbstractModel</code></pre><p>A mutable struct representing a Quantum ESPRESSO (QE) model configuration.</p><p><strong>Fields</strong></p><ul><li><code>path_to_calc::String</code>: Path to the calculation directory.</li><li><code>abs_disp::Float64</code>: Absolute displacement value used in calculations.</li><li><code>path_to_qe::String</code>: Path to the Quantum ESPRESSO executable.</li><li><code>mpi_ranks::Int</code>: Number of MPI ranks to use for parallel execution.</li><li><code>sc_size::Int</code>: Supercell size.</li><li><code>k_mesh::Int</code>: Number of k-points in the mesh.</li><li><code>Ndispalce::Int</code>: Number of displacements.</li><li><code>unitcell::Dict</code>: Dictionary containing unit cell information.</li><li><code>scf_parameters::Dict</code>: Dictionary of self-consistent field (SCF) parameters.</li><li><code>use_symm::Bool</code>: Whether to use symmetry in calculations.</li><li><code>symmetries::Symmetries</code>: Symmetry information associated with the model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/model.jl#L23-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.ModelKCW" href="#ElectronPhonon.ModelKCW"><code>ElectronPhonon.ModelKCW</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModelKCW &lt;: AbstractModel</code></pre><p>A mutable struct representing a Koopmans model configuration.</p><p><strong>Fields</strong></p><ul><li><code>path_to_calc::String</code>: Path to the calculation directory.</li><li><code>spin_channel::String</code>: Spin channel used in the calculation (e.g., &quot;up&quot;, &quot;down&quot;).</li><li><code>abs_disp::Float64</code>: Absolute displacement value for phonon calculations.</li><li><code>path_to_qe::String</code>: Path to the Quantum ESPRESSO executable.</li><li><code>mpi_ranks::Int</code>: Number of MPI ranks to use for parallel calculations.</li><li><code>sc_size::Int</code>: Supercell size.</li><li><code>k_mesh::Int</code>: Number of k-points in the mesh.</li><li><code>Ndispalce::Int</code>: Number of displacements.</li><li><code>unitcell::Dict</code>: Dictionary containing unit cell information.</li><li><code>scf_parameters::Dict</code>: Dictionary of self-consistent field (SCF) parameters.</li><li><code>use_symm::Bool</code>: Whether to use symmetry in calculations.</li><li><code>symmetries::Symmetries</code>: Symmetry operations associated with the model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/model.jl#L55-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.create_model" href="#ElectronPhonon.create_model"><code>ElectronPhonon.create_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_model(; path_to_calc::String = &quot;./&quot;,
               abs_disp::Float64 = 1e-3,
               path_to_qe::String = &quot;./&quot;,
               mpi_ranks::Int = 1,
               sc_size::Int = 2,
               k_mesh::Int = 1,
               Ndispalce::Int = 0,
               unitcell::Dict = Dict(),
               scf_parameters::Dict = Dict(),
               use_symm::Bool = false,
               symmetries::Symmetries = Symmetries([],[],[]))</code></pre><p>Create and initialize a <code>ModelQE</code> object with the specified parameters.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>path_to_calc::String = &quot;./&quot;</code>: Path to the calculation directory.</li><li><code>abs_disp::Float64 = 1e-3</code>: Absolute displacement value for atomic positions.</li><li><code>path_to_qe::String = &quot;./&quot;</code>: Path to the Quantum ESPRESSO executable.</li><li><code>mpi_ranks::Int = 1</code>: Number of MPI ranks to use for calculations.</li><li><code>sc_size::Int = 2</code>: Size of the supercell.</li><li><code>k_mesh::Int = 1</code>: Number of k-points in the mesh.</li><li><code>Ndispalce::Int = 0</code>: Number of displacements to consider.</li><li><code>unitcell::Dict = Dict()</code>: Dictionary containing unit cell information.</li><li><code>scf_parameters::Dict = Dict()</code>: Dictionary of self-consistent field (SCF) parameters.</li><li><code>use_symm::Bool = false</code>: Whether to use symmetries in the calculation.</li><li><code>symmetries::Symmetries = Symmetries([],[],[])</code>: Symmetry operations to use.</li></ul><p><strong>Returns</strong></p><ul><li><code>ModelQE</code>: An initialized <code>ModelQE</code> object with the specified settings.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/model.jl#L90-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.create_model_kcw" href="#ElectronPhonon.create_model_kcw"><code>ElectronPhonon.create_model_kcw</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_model_kcw(path_to_calc::String,
                 spin_channel::String,
                 abs_disp::Float64,
                 path_to_qe::String,
                 mpi_ranks::Int,
                 sc_size::Int,
                 k_mesh::Int,
                 Ndispalce::Int,
                 unitcell::Dict,
                 scf_parameters::Dict,
                 use_symm::Bool)</code></pre><p>Create and return a <code>ModelKCW</code> object with the specified parameters.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_calc::String</code>: Path to the calculation directory.</li><li><code>spin_channel::String</code>: Spin channel identifier (e.g., &quot;up&quot;, &quot;down&quot;).</li><li><code>abs_disp::Float64</code>: Absolute displacement value.</li><li><code>path_to_qe::String</code>: Path to the Quantum ESPRESSO executable.</li><li><code>mpi_ranks::Int</code>: Number of MPI ranks to use.</li><li><code>sc_size::Int</code>: Supercell size.</li><li><code>k_mesh::Int</code>: Number of k-points in the mesh.</li><li><code>Ndispalce::Int</code>: Number of displacements.</li><li><code>unitcell::Dict</code>: Dictionary containing unit cell information.</li><li><code>scf_parameters::Dict</code>: Dictionary of self-consistent field (SCF) parameters.</li><li><code>use_symm::Bool</code>: Whether to use symmetry in calculations.</li></ul><p><strong>Returns</strong></p><ul><li><code>ModelKCW</code>: An instance of the <code>ModelKCW</code> type initialized with the provided parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/model.jl#L141-L171">source</a></section><section><div><pre><code class="language-julia hljs">create_model_kcw(; path_to_calc::String = &quot;./&quot;,
                  spin_channel::String = &quot;up&quot;,
                  abs_disp::Float64 = 1e-3,
                  path_to_qe::String = &quot;./&quot;,
                  mpi_ranks::Int = 1,
                  sc_size::Int = 2,
                  k_mesh::Int = 1,
                  Ndispalce::Int = 0,
                  unitcell::Dict = Dict(),
                  scf_parameters::Dict = Dict(),
                  use_symm::Bool = false,
                  symmetries::Symmetries = Symmetries([],[],[]))</code></pre><p>Create and initialize a <code>ModelKCW</code> object with the specified parameters.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>path_to_calc::String</code>: Path to the calculation directory. Defaults to <code>&quot;./&quot;</code>.</li><li><code>spin_channel::String</code>: Spin channel to use (e.g., <code>&quot;up&quot;</code> or <code>&quot;down&quot;</code>). Defaults to <code>&quot;up&quot;</code>.</li><li><code>abs_disp::Float64</code>: Absolute displacement value. Defaults to <code>1e-3</code>.</li><li><code>path_to_qe::String</code>: Path to Quantum ESPRESSO executables. Defaults to <code>&quot;./&quot;</code>.</li><li><code>mpi_ranks::Int</code>: Number of MPI ranks to use. Defaults to <code>1</code>.</li><li><code>sc_size::Int</code>: Supercell size. Defaults to <code>2</code>.</li><li><code>k_mesh::Int</code>: Number of k-points in the mesh. Defaults to <code>1</code>.</li><li><code>Ndispalce::Int</code>: Number of displacements. Defaults to <code>0</code>.</li><li><code>unitcell::Dict</code>: Dictionary describing the unit cell. Defaults to an empty <code>Dict()</code>.</li><li><code>scf_parameters::Dict</code>: Dictionary of self-consistent field (SCF) parameters. Defaults to an empty <code>Dict()</code>.</li><li><code>use_symm::Bool</code>: Whether to use symmetries. Defaults to <code>false</code>.</li><li><code>symmetries::Symmetries</code>: Symmetries object. Defaults to <code>Symmetries([],[],[],[])</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>ModelKCW</code>: An initialized <code>ModelKCW</code> object.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/model.jl#L187-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.Electrons" href="#ElectronPhonon.Electrons"><code>ElectronPhonon.Electrons</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Electrons</code></pre><p>A structure representing electronic properties in a model.</p><p><strong>Fields</strong></p><ul><li><code>U_list::Array</code>: List of brakets beetwen displaced(+tau) and undisplaced wavefunctions.</li><li><code>V_list::Array</code>: List of brakets beetwen displaced(-tau) and undisplaced wavefunctions.</li><li><code>ϵkᵤ_list::Array</code>: List of undisplaced electronic energies.</li><li><code>ϵₚ_list::Array</code>: List of displaced(+tau) electronic energies.</li><li><code>ϵₚₘ_list::Array</code>: List of displaced(+tau) electronic energies.</li><li><code>k_list::Array</code>: List of k-points.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/model.jl#L240-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.Phonons" href="#ElectronPhonon.Phonons"><code>ElectronPhonon.Phonons</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Phonons</code></pre><p>A structure representing phonon properties.</p><p><strong>Fields</strong></p><ul><li><code>M_phonon::Array{}</code>: Array transfromation from crystall to cartesian basis.</li><li><code>ωₐᵣᵣ_ₗᵢₛₜ::Array{}</code>: Array of phonon frequencies.</li><li><code>εₐᵣᵣ_ₗᵢₛₜ::Array{}</code>: Array of phonon energies or eigenvalues.</li><li><code>mₐᵣᵣ::Array{}</code>: Array of masses (typically <code>Float64</code>).</li></ul><p><strong>Notes</strong></p><p>All fields are currently typed as <code>Array{}</code>. For improved type safety and performance, consider specifying element types, e.g., <code>Array{Float64}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/model.jl#L262-L275">source</a></section></article><h2 id="IO"><a class="docs-heading-anchor" href="#IO">IO</a><a id="IO-1"></a><a class="docs-heading-anchor-permalink" href="#IO" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.parse_frozen_params" href="#ElectronPhonon.parse_frozen_params"><code>ElectronPhonon.parse_frozen_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_frozen_params(path_to_json)</code></pre><p>Parses a JSON file containing parameters for a frozen phonon calculation and merges them with default values.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_json::AbstractString</code>: Path to the JSON file containing parameter overrides.</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, Any}</code>: A dictionary with the merged parameters, where defaults are used unless overridden by the JSON file.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/io.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.parse_qe_in" href="#ElectronPhonon.parse_qe_in"><code>ElectronPhonon.parse_qe_in</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_qe_in(path_to_scf::String)</code></pre><p>Parses a Quantum ESPRESSO SCF input file and extracts structural and calculation parameters.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_scf::String</code>: Path to the Quantum ESPRESSO SCF input file.</li></ul><p><strong>Returns</strong></p><ul><li><code>unitcell::Dict</code>: A dictionary containing unit cell information:<ul><li><code>:symbols</code>: Chemical symbols of the atoms.</li><li><code>:cell</code>: Lattice vectors of the unit cell.</li><li><code>:scaled_positions</code>: Atomic positions in fractional coordinates.</li><li><code>:masses</code>: Atomic masses.</li></ul></li><li><code>scf_parameters::Dict</code>: A dictionary containing parsed SCF calculation parameters, including:<ul><li><code>:format</code>: The format of the input file (set to <code>&quot;espresso-in&quot;</code>).</li><li><code>:crystal_coordinates</code>: Boolean indicating if crystal coordinates are used.</li><li>Additional parameters parsed from the input file.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/io.jl#L41-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.getfirst" href="#ElectronPhonon.getfirst"><code>ElectronPhonon.getfirst</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getfirst(f::Function, A)</code></pre><p>Returns the first element <code>el</code> in the collection <code>A</code> for which the predicate function <code>f(el)</code> returns <code>true</code>. If no such element is found, returns <code>nothing</code>.</p><p><strong>Arguments</strong></p><ul><li><code>f::Function</code>: A predicate function that takes an element of <code>A</code> and returns a <code>Bool</code>.</li><li><code>A</code>: A collection to search through.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/io.jl#L78-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElectronPhonon.parse_file" href="#ElectronPhonon.parse_file"><code>ElectronPhonon.parse_file</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_file(f::AbstractString, parse_funcs::Vector{&lt;:Pair{NeedleType, Any}}; out = Dict{Symbol, Any}())</code></pre><p>Parses the file at path <code>f</code> line by line, applying parsing functions specified in <code>parse_funcs</code> to lines that match given patterns.</p><p><strong>Arguments</strong></p><ul><li><code>f::AbstractString</code>: Path to the file to be parsed.</li><li><code>parse_funcs::Vector{&lt;:Pair{NeedleType, Any}}</code>: A vector of pairs, where each pair consists of a pattern (<code>NeedleType</code>) to search for in each line, and a parsing function to apply when the pattern is found. The parsing function should accept three arguments: the output dictionary, the current line, and the file handle.</li><li><code>out::Dict{Symbol, Any}</code> (optional): An output dictionary to store parsed results. Defaults to an empty dictionary.</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{Symbol, Any}</code>: The dictionary containing parsed results.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/io.jl#L96-L108">source</a></section><section><div><pre><code class="language-julia hljs">parse_file(f::AbstractString, args...; kwargs...)</code></pre><p>Opens the file specified by the path <code>f</code> in read mode and passes the resulting file handle, along with any additional positional (<code>args...</code>) and keyword arguments (<code>kwargs...</code>), to the inner <code>parse_file</code> method for further processing.</p><p><strong>Arguments</strong></p><ul><li><code>f::AbstractString</code>: The path to the file to be parsed.</li><li><code>args...</code>: Additional positional arguments to be forwarded to the inner <code>parse_file</code> method.</li><li><code>kwargs...</code>: Additional keyword arguments to be forwarded to the inner <code>parse_file</code> method.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Koulb/ElePhAny.jl/blob/505596399d74483e6b85817e44ab53bb125572da/src/io.jl#L134-L145">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 20 August 2025 11:04">Wednesday 20 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
